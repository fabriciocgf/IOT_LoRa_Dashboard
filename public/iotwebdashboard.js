!function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../dist/",a(a.s=0)}([function(e,t){!function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,a.c=t,a.p="../dist/",a(0)}([function(e,t,a){"use strict";a(1);var n=a(6),i=(a(29),a(31),a(22),a(13)),r=a(26),o=a(27);window.WIDGET_TYPE_BARGRAPH=1,window.WIDGET_TYPE_GAUGE=2,window.WIDGET_TYPE_LINEGRAPH=3,window.WIDGET_TYPE_MAP=4,window.WIDGET_TYPE_PLAINDATA=5,window.WIDGET_TYPE_PLAINTEXT=6,window.WIDGET_TYPE_THERMOMETER=7,window.WIDGET_TYPE_TRAFFICLIGHT=8,window.TYPE_COLOR=0,window.TYPE_STRING=1,window.TYPE_INTEGER=2,window.TYPE_BOOLEAN=3,window.TYPE_ARRAY=4,window.TYPE_DATE=5,window.TYPE_DROPDOWN=6,window.TYPE_NUMBER=7,window.TYPE_FUZZY_SENSOR_SEARCH=8,window.TYPE_OBJECT=9,window.TYPE_OTHER=10,window.UNIT_MILLISECOND=0,window.UNIT_SECOND=1,window.UNIT_MINUTE=2,window.UNIT_HOUR=3,window.UNIT_DAY=4,window.UNIT_MONTH=5,window.UNIT_YEAR=6,window.MARKER_TYPE_PLAIN=0,window.MARKER_TYPE_PLAINVALUE=1,window.MARKER_TYPE_TRAFFICLIGHT=2,window.MARKER_TYPE_HISTORY=3,window.COLOR_RED=1,window.COLOR_YELLOW=2,window.COLOR_GREEN=3,window.printAJAXerrors=!0,window.iotDB={create:function(e){null==e.language&&(e.language="en"),e.id="iot-db",new n.View(e.id,e.backgroundTransparent,e.disableConfiguration,e.disableImportExportCMS,e.disableDownloadUpload,e.enableNoDistraction,e.language,window.iotDB.onLoad),e.baseDir?window.iotBaseDir=e.baseDir:window.iotBaseDir="./"},getMapLayers:function(){return(new i.MapWidgetFactory).getMapLayers()},exportUserConfig:function(){return(new r.ImportExport).configFileExport()},importUserConfig:function(e){(new r.ImportExport).configFileImport(e)},importUserConfigJSON:function(e){var t=(new o.Parser).parseDates(e);(new r.ImportExport).dataModelProxy.importNewUserConfig(t)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(2),r=a(9),o=a(37),s=a(38),l=a(39),u=a(40),d=a(41),c=a(42),f=a(5),g=a(35),h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.datamodel=new i.DataModel,this.dashboardServices=new r.DashboardServices}return n(e,[{key:"getWidgetData",value:function(e){return this.datamodel.getUserConfig().getWidgetConfig().getWidgetDataByID(e)}},{key:"getUserConfig",value:function(){return this.datamodel.getUserConfig()}},{key:"setDataModel",value:function(e){this.datamodel=e}},{key:"addWidget",value:function(e,t,a,n,i,r,h){var v=void 0;switch(n){case WIDGET_TYPE_GAUGE:v=new o.GaugeWidgetData(e);break;case WIDGET_TYPE_BARGRAPH:v=new s.BarGraphData(e);break;case WIDGET_TYPE_LINEGRAPH:v=new l.LineGraphWidgetData(e);break;case WIDGET_TYPE_PLAINDATA:v=new u.PlainDataWidgetData(e);break;case WIDGET_TYPE_THERMOMETER:v=new d.ThermometerWidgetData(e);break;case WIDGET_TYPE_TRAFFICLIGHT:v=new c.TrafficLightWidgetData(e);break;case WIDGET_TYPE_MAP:v=new f.MapWidgetData(e);break;case WIDGET_TYPE_PLAINTEXT:v=new g.PlainTextWidgetData(e);break;default:console.error("unknown widget type")}i&&v.setConfigurableData(i),r&&v.setPosition(r),h&&v.setSize(h),v.registerViewCallback(t,a),this.datamodel.getUserConfig().getWidgetConfig().addWidgetData(v)}},{key:"changeWidgetData",value:function(e,t){this.datamodel.getUserConfig().getWidgetConfig().changeWidgetData(e,t)}},{key:"removeWidgetData",value:function(e){this.datamodel.getUserConfig().getWidgetConfig().removeWidgetData(e)}},{key:"getUserConfig",value:function(){return this.datamodel.getUserConfig()}},{key:"setUserConfig",value:function(e){this.datamodel.setUserConfig(e)}},{key:"importNewUserConfig",value:function(e){this.datamodel.getUserConfig().setUserConfigData(e),this.datamodel.getUserConfig().getWidgetConfig().removeAllWidgetData(),this.dashboardServices.createWidgetsFromConfig(e.widgetConfig)}}]),e}();t.DataModelProxy=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(3),r=a(36),o=null,s=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,this._userConfig=new i.UserConfig,this._dashboardConfig=new r.DashboardConfig,this._observers=[]),o}return n(e,[{key:"observe",value:function(e){return this._observers.push(e),this}},{key:"_notify",value:function(){for(var e in this._observers)e.notify()}},{key:"getUserConfig",value:function(){return this._userConfig}},{key:"setUserConfig",value:function(e){this._userConfig=e}}]),e}();t.DataModel=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(4),r=a(36),o=null,s=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,this.widgetConfig=new i.WidgetConfig,this.dashboardConfig=new r.DashboardConfig),o}return n(e,[{key:"getWidgetConfig",value:function(){return this.widgetConfig}},{key:"getDashboardConfig",value:function(){return this.dashboardConfig}},{key:"setWidgetConfig",value:function(e){this.widgetConfig=e}},{key:"setDashboardConfig",value:function(e){this.dashboardConfig=e}},{key:"setDashboardConfigData",value:function(e){this.dashboardConfig.setTitle(e.title),this.dashboardConfig.setServerList(e.serverList)}},{key:"setWidgetConfigData",value:function(e){this.widgetConfig.setConfigContent(e)}},{key:"setUserConfigData",value:function(e){o.setDashboardConfigData(e.dashboardConfig)}}]),e}();t.UserConfig=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(5);var i=a(35),r=null,o=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r||(r=this,this.widgetDataArray=[],this.datastreamFunctions=[]),r}return n(e,[{key:"getConfigContent",value:function(){return this.widgetDataArray}},{key:"setConfigContent",value:function(e){this.widgetDataArray=e}},{key:"getWidgetDataByID",value:function(e){return this.widgetDataArray.find(function(t){return t.id===e})}},{key:"addWidgetData",value:function(e){if(this.widgetDataArray.push(e),!(e instanceof i.PlainTextWidgetData))for(var t in this.datastreamFunctions)this.datastreamFunctions[t](!0,!1,e)}},{key:"widgetDataChanged",value:function(e){var t=this.getWidgetDataByID(e);if(!(t instanceof i.PlainTextWidgetData||null==t))for(var a in this.datastreamFunctions)this.datastreamFunctions[a](!0,!0,t)}},{key:"removeWidgetData",value:function(e){var t=this.getWidgetDataByID(e);t.destroy();var a=this.widgetDataArray.indexOf(t);if(this.widgetDataArray.splice(a,1),!(t instanceof i.PlainTextWidgetData||null==t))for(var n in this.datastreamFunctions)this.datastreamFunctions[n](!1,!0,t)}},{key:"removeAllWidgetData",value:function(){var e=[];for(var t in this.widgetDataArray)e.push(this.widgetDataArray[t].id);for(var a=0;a<e.length;a++)this.removeWidgetData(e[a])}},{key:"registerDataStreamsObserver",value:function(e){this.datastreamFunctions.push(e)}}]),e}();t.WidgetConfig=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_MAP,this.dataCallbacks=[],this.configCallbacks=[],this.dataObserverCallbacks=[this.newData.bind(this)],this.allData=[],this.allData.push([]),this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!0,DataStream_observedArea:!1,DataStream_phenomenonTime:!0,DataStream_resultTime:!1,Observation_phenomenonTime:!1,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!0,FeatureOfInterest_description:!0,FeatureOfInterest_encodingType:!0,FeatureOfInterest_feature:!0,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!0,Thing_Location_name:!0,Thing_Location_description:!0,Thing_Location_encodingType:!0,Thing_Location_location:!0}}},{key:"_initConfigurableData",value:function(){var e=new Date;e.setMinutes((new Date).getMinutes()+1),this.configurableData={title:{data:"Map Widget",type:TYPE_STRING},zoom:{data:13,type:TYPE_INTEGER},mapURL:{data:"https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoidmV4dXJ5IiwiYSI6ImNpd3R2ZzY5djAwbzcydXFyazRsam80cDAifQ.TaIW3pR4RS3UuyZg61HV6g",type:TYPE_STRING},attribution:{data:"Map data &copy; <a href='http://openstreetmap.org'>OpenStreetMap</a> contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/'>CC-BY-SA</a>, Imagery © <a href='http://mapbox.com'>Mapbox</a>",type:TYPE_STRING},latitude:{data:49.014,type:TYPE_NUMBER},longitude:{data:8.404,type:TYPE_NUMBER},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MINUTE,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:e,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER},overlayType:{data:MARKER_TYPE_PLAIN,type:TYPE_DROPDOWN,options:{plainMarker:MARKER_TYPE_PLAIN,plainValueMarker:MARKER_TYPE_PLAINVALUE,trafficLightMarker:MARKER_TYPE_TRAFFICLIGHT,historyLine:MARKER_TYPE_HISTORY}},thresholdMiddle:{data:0,type:TYPE_NUMBER},thresholdUpper:{data:0,type:TYPE_NUMBER},lowerRangeColor:{data:COLOR_GREEN,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}},middleRangeColor:{data:COLOR_YELLOW,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}},upperRangeColor:{data:COLOR_RED,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"newData",value:function(e){for(var t in this.allData[0]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return this.dataObserverCallbacks}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this._buildDataCallbacks(e.sensorThingsConfiguration.data),this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}},{key:"_buildDataCallbacks",value:function(e){var t=this;this.allData=[],this.dataObserverCallbacks=[];var a=0,n=function(e){t.allData.push([]);var n=a;t.dataObserverCallbacks.push(function(e){for(var t in this.allData[n]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}.bind(t)),a++};for(var i in e)n()}}]),e}();t.MapWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(7),r=a(8),o=a(28),s=a(29),l=null,u=null,d=null,c=null,f=function(){function e(t,a,n,i,f,g,h,v){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l||void 0==t||(c={id:t,transparent:a,disableConfig:n,disableImExCMS:i,disableUpDownload:f,enableNoDistr:g,lang:h,callback:v},(l=this)._setUpLanguage(c.lang),u=new r.UserEvents,d=new o.UserConfigurationView,new s.DataQueryObserverProxy,$(document).ready(l._loadDashboardHTML)),l}return n(e,[{key:"_loadDashboardHTML",value:function(){$("#iot-db").load(window.iotBaseDir+"iotwebdashboard.html",l._initializeDashboard)}},{key:"_initializeDashboard",value:function(){$("#btn-configure").text(window.iotlg.headerConf),$("#addwidget_dropdown").html(window.iotlg.headerAddNew+" <span class='caret'></span>"),$("#iotdbHeaderTitle").text(u.loadUserConfig().getDashboardConfig().getTitle()),$("#conf_upload").text(window.iotlg.configUpload),$("#conf_download").text(window.iotlg.configDownload),$("#conf_import").text(window.iotlg.configImport),$("#conf_export").text(window.iotlg.configExport),$("#conf_save").text(window.iotlg.configSave);var e={float:!0,animate:!0,cellHeight:Math.round(.8*$("#"+c.id).width()*60/800),disableDrag:c.disableConfig,disableResize:c.disableConfig};if($(".grid-stack").gridstack(e),l._gridstack=$(".grid-stack").data("gridstack"),$(".grid-stack").on("change",u.widgetChange),$("#btn-configure").click(function(e){return d._toggleConfigure()}),$("#addwidget_dropdown").ready(function(){return l._loadDropdownItems()}),$("#conf_close").click(function(e){return d._toggleConfigure()}),$("#conf_save").click(function(e){return d._saveConfig()}),$("#conf_upload").click(function(){return d._importConfig()}),$("#conf_download").click(function(e){return d._exportConfig()}),$("#conf_import").click(function(e){return d._importFromCMS()}),$("#conf_export").click(function(e){return d._exportToCMS()}),$("#btn-no-distraction").click(function(){return l._toggleDistraction()}),$("#conf-input-title").on("input",function(){return d._setModified(!0)}),c.transparent&&$("#iot-db").css("background-color","transparent"),c.disableImExCMS&&($("#conf_import").remove(),$("#conf_export").remove()),c.disableUpDownload&&($("#conf_download").remove(),$("#conf_upload").remove()),c.disableConfig){var t=$("<style>.remove-widget-button, .configureWidgetButton { display: none; }</style>");$("html > head").append(t),$("#btn-no-distraction").remove(),$("#btn-configure").remove(),$("#addwidget_dropdown").remove()}c.enableNoDistr&&$("#iot-db").addClass("no-distract"),c.callback&&c.callback()}},{key:"_setUpLanguage",value:function(e){if("en"===e||void 0===window[e])window.iotlg=i.en;else for(var t in window.iotlg=window[e],i.en)i.en.hasOwnProperty(t)&&(window.iotlg.hasOwnProperty(t)||(window.iotlg[t]=i.en[t]));window.iotlg.widgetResName1="BarGraph",window.iotlg.widgetResName2="Gauge",window.iotlg.widgetResName3="LineGraph",window.iotlg.widgetResName4="Map",window.iotlg.widgetResName5="PlainData",window.iotlg.widgetResName6="PlainText",window.iotlg.widgetResName7="Thermometer",window.iotlg.widgetResName8="TrafficLight"}},{key:"removeWidget",value:function(e){e="#"+e,l._gridstack.removeWidget($(e).parent())}},{key:"addWidget",value:function(e,t){l._gridstack.addWidget(t,0,0,5,5,!0,null,null,null,null,e),$(t).find(".ui-resizable-se").mouseup(function(e){return setTimeout(function(){return $(e.target.parentElement).find(".rgraph_domtext_wrapper").resize()},300)}),$(t).find(".rgraph_domtext_wrapper").resize()}},{key:"addWidgetAtPosition",value:function(e,t,a,n,i,r){l._gridstack.addWidget(t,a,n,i,r),$(t).find(".ui-resizable-se").mouseup(function(e){return setTimeout(function(){return $(e.target.parentElement).find(".rgraph_domtext_wrapper").resize()},300)}),$(t).find(".rgraph_domtext_wrapper").resize()}},{key:"getWidgetAttrFromId",value:function(e){var t=$("#"+e).parent();return[{x:t.attr("data-gs-x"),y:t.attr("data-gs-y")},{width:t.attr("data-gs-width"),height:t.attr("data-gs-height")}]}},{key:"_setAddWidgetItemOnClick",value:function(e){var t=$("a[data-type="+e+"]");(t=t[0]).onclick=function(e){u.addWidget(e.target.getAttribute("data-type"))}}},{key:"_loadDropdownItems",value:function(){var e=$("#addwidget_dropdown_menu")[0],t=l._getWidgetTypes();for(var a in e.innerHTML="",e.style.padding="0px 0",t){var n=t[a];e.appendChild(l._getDropdownMenuItem(n,window.iotlg["widgetName"+n],window.iotlg["widgetResName"+n])),l._setAddWidgetItemOnClick(n)}}},{key:"_getDropdownMenuItem",value:function(e,t,a){var n=document.createElement("LI");return n.classList.add("dropdown-item"),n.innerHTML='<a href="#" data-type="'+e+'">'+t+"</a>",n.style.backgroundImage="url('"+window.iotBaseDir+"res/"+a+".png')",n}},{key:"getLoadingWidgets",value:function(){return void 0==l._loadingWidgets&&(l._loadingWidgets=[]),l._loadingWidgets}},{key:"pushLoading",value:function(e){void 0==l._loadingWidgets&&(l._loadingWidgets=[]),l._loadingWidgets.push(e),l.setLoading(l._loadingWidgets.length>0)}},{key:"popLoading",value:function(e){void 0==l._loadingWidgets&&(l._loadingWidgets=[]);var t=l._loadingWidgets.indexOf(e);-1==t||l._loadingWidgets.splice(t,1),l.setLoading(l._loadingWidgets.length>0)}},{key:"setLoading",value:function(e){e?$("#iot-db").addClass("loading"):$("#iot-db").removeClass("loading")}},{key:"_toggleDistraction",value:function(){$("#iot-db").toggleClass("no-distract"),$(".rgraph_domtext_wrapper").resize()}},{key:"_getWidgetTypes",value:function(){return[WIDGET_TYPE_BARGRAPH,WIDGET_TYPE_GAUGE,WIDGET_TYPE_LINEGRAPH,WIDGET_TYPE_MAP,WIDGET_TYPE_PLAINDATA,WIDGET_TYPE_PLAINTEXT,WIDGET_TYPE_THERMOMETER,WIDGET_TYPE_TRAFFICLIGHT]}}]),e}();t.View=f},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.en={headerConf:"Configure",headerAddNew:"Add Widget",headerDefTitle:"Default",widgetDefTitle:"Default Widget",widgetLineGraphTitle:"Line Graph Widget",widgetGaugeTitle:"Gauge Widget",widgetMapTitle:"Map Widget",widgetPlainTextTitle:"Plain Text Widget",widgetPlainDataTitle:"Plain Data Widget",widgetThermometerTitle:"Thermometer Widget",widgetTrafficLightTitle:"Traffic Light Widget",widgetLastUpdate:"Last update",widgetName1:"BarGraph",widgetName2:"Gauge",widgetName3:"LineGraph",widgetName4:"Map",widgetName5:"PlainData",widgetName6:"PlainText",widgetName7:"Thermometer",widgetName8:"TrafficLight",dbTitle:"Title: ",dbConfig:"Configure ",addButton:"Add",configDownload:"Download",configUpload:"Upload",configImport:"Import from CMS",configExport:"Export to CMS",configSave:"Apply",warningConfigModified:"The Dashboard Configuration has been modified. Please apply or discard the changes before exporting or downloading the configuration.",dataStreamUrl_Tooltip:"URL to a datastream",mqttEnabled_Tooltip:"If the Datastream should use MQTT",mqttUrl_Tooltip:"The Url to the MQTT Service",mqttBaseTopic_Tooltip:"The Topic for the DataStream to be watched",updateIntervalMs_Tooltip:"The updateinterval for a not MQTT widget in milliseconds",dateFormat:"yyyy/mm/dd hh:MM:ss",zoom_Tooltip:"Standard Zoom Level",mapURL_Tooltip:"Url to retrieve the Map",attribution_Tooltip:"Attribution",latitude_Tooltip:"Startpoint latitude",longitude_Tooltip:"Startpoint longitude",overlays_Tooltip:"Add overlays here",title_Tooltip:"Title of the Widget",timeIntervalRelative_Tooltip:"Relative timeinterval",timeIntervalUnit_Tooltip:"Unit of the timeinterval",startTime_Tooltip:"Starttime for an absolute timeinterval",endTime_Tooltip:"Endtime for an absolute timeinterval",timeInterval_Tooltip:"Size of a relative timeinterval",shadow_Tooltip:"Usage of a shadow",textColor_Tooltip:"Color of the text",tickmarksBigColor_Tooltip:"The color of the big tickmarks on the chart",tickmarksMediumColor_Tooltip:"The color of the medium tickmarks on the chart.",tickmarksSmallColor_Tooltip:"The color of the small tickmarks on the chart",backgroundColor_Tooltip:"The background color of the chart.",borderInnerColor_Tooltip:"This is the color of the inner border.",borderOuterColor_Tooltip:"This is the color of the outer border",borderOutlineColor_Tooltip:"This is the color of the border around the Gauge",needleColor_Tooltip:"This is the color of the needle",needleType_Tooltip:"The appearance of the needles. It can be triangle or line",needleTail_Tooltip:"Whether the tail for the needle is shown",centerpinRadius_Tooltip:"This is ths radius of the centerpin",titleTop_Tooltip:"Title on top of the Gauge, if any",titleTopSize_Tooltip:"Size of the title on top",titleTopColor_Tooltip:"Color of the title on top",titleBottom_Tooltip:"Title below the Gauge",titleBottomColor_Tooltip:"Color of the title below",titleBottomSize_Tooltip:"Size of the title below",labelsCentered_Tooltip:"Whether the labels are centered horizontally and vertically",labelsOffset_Tooltip:"This is the offset the labels are positioned at",textAccessible_Tooltip:"Allows DOM in places of canvas text",colorsRanges_Tooltip:"With this you can totally control the colors used on the chart",xscale_Tooltip:"Sets the x scale",backgroundGridBorder_Tooltip:"Determines whether a border line is drawn around the grid",backgroundGridVlines_Tooltip:"Determines whether to draw the vertical grid lines",backgroundBarcolor1_Tooltip:"The color of the background bars (1 of 2)",backgroundBarcolor2_Tooltip:"The color of the background bars (2 of 2)",backgroundGridColor_Tooltip:"The color of the background grid",tickmarks_Tooltip:"What kind of tickmarks to use on the chart",ticksize_Tooltip:"Sets size of the tickmarks",line_Tooltip:"Defines the different lines",lineColors_Tooltip:"Colors of the lines",titleXaxis_Tooltip:"Title on the X Axis",titleYaxis_Tooltip:"Title on the Y Axis",pointColor_Tooltip:"Color of the Points to draw",ymin_Tooltip:"Minimum value on the Y Axis",valueSize_Tooltip:"Fontsize of the Value",unitSize_Tooltip:"Fontsize of the Unit",unit_Tooltip:"Unit to show after the Value",textWidgetDefaultText:"Click on the Configuration Button to customize this text.",fontSize_Tooltip:"The fontsize for the text",text_Tooltip:"Text to display",max_Tooltip:"Maximum of the Range",min_Tooltip:"Minimum of the Range",scaleVisible_Tooltip:"Defaulting to false, this controls whether the scale is visible",scaleDecimals_Tooltip:"This allows you to control the amount of decimals that the labels have. MIN: 0, MAX: 20",gutterLeft_Tooltip:"Space to the left",gutterRight_Tooltip:"Space to the right",valueLabel_Tooltip:"Enable the Value Label",lower_Tooltip:"Value of the lower end of the Yellow Range",higher_Tooltip:"Value of the upper end of the Yellow Range"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(9),r=a(26),o=a(1),s=null,l=null,u=null,d=null,c=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s||(s=this,l=new i.DashboardServices,u=new r.ImportExport,d=new o.DataModelProxy),s}return n(e,[{key:"loadUserConfig",value:function(){return l.loadUserConfig()}},{key:"setUserConfig",value:function(e){l.setUserConfig(e)}},{key:"dashboardConfigChanged",value:function(){var e=s.loadUserConfig();l.applyConfig(e)}},{key:"addWidget",value:function(e){l.createWidget(e)}},{key:"removeWidget",value:function(e){l.removeWidget(e)}},{key:"widgetChange",value:function(e,t){t&&t.forEach(function(e){var t=d.getWidgetData(e.id);t&&(t.position={x:e.x,y:e.y},t.size={height:e.height,width:e.width})})}},{key:"configureWidget",value:function(e){l.configureWidget(e)}},{key:"importConfig",value:function(){u.configJSONImport()}},{key:"exportConfig",value:function(){u.configJSONExport()}},{key:"importFromCMS",value:function(){window.iotDB.onLoadConfig&&window.iotDB.onLoadConfig()}},{key:"exportToCMS",value:function(){window.iotDB.onSaveConfig&&window.iotDB.onSaveConfig()}}]),e}();t.UserEvents=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(10),r=a(13),o=a(5),s=a(6),l=a(1),u=a(19),d=null,c=null,f=null,g=null,h=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d||(d=this,f=new i.WidgetFactory,g=new s.View,c=new l.DataModelProxy),d}return n(e,[{key:"loadUserConfig",value:function(){return c.getUserConfig()}},{key:"setUserConfig",value:function(e){c.setUserConfig(e)}},{key:"applyConfig",value:function(e){$(".navbar-brand").text(e.dashboardConfig.getTitle()),$("#conf_title").text(window.iotlg.dbConfig+e.dashboardConfig.getTitle())}},{key:"createWidget",value:function(e,t){e=parseInt(e);var a=f.createWidget(e,function(a,n,i){var r=g.getWidgetAttrFromId(a);c.addWidget(a,n,i,e,t,r[0],r[1])});g.addWidget("iotdbWidget"+a[0],a[1])}},{key:"createWidgetWithPosAndSize",value:function(e,t,a,n){e=parseInt(e);var i=f.createWidget(e,function(i,r,o){c.addWidget(i,r,o,e,n,t,a)});g.addWidgetAtPosition("iotdbWidget"+i[0],i[1],t.x,t.y,a.width,a.height)}},{key:"createWidgetsFromConfig",value:function(e){for(var t=e.widgetDataArray,a=0;a<t.length;a++)console.log("Create Widget",t[a]),t[a].position&&t[a].size?this.createWidgetWithPosAndSize(t[a].type,t[a].position,t[a].size,t[a].configurableData):this.createWidget(t[a].type,t[a].configurableData)}},{key:"removeWidget",value:function(e){c.getWidgetData(e)instanceof o.MapWidgetData&&new r.MapWidgetFactory(null).removeLayerGroup(e),c.removeWidgetData(e)}},{key:"configureWidget",value:function(e){new u.WidgetConfigurationView(c.getWidgetData(e))}}]),e}();t.DashboardServices=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(11),r=a(12),o=a(13),s=a(14),l=a(15),u=a(16),d=a(17),c=a(18),f=null,g=null,h=null,v=null,p=null,_=null,y=null,m=null,T=null,b=null,w='\n        <div id="templateWidget" class="grid-stack-item-content">\n        <div class="widget-header">\n        <div class="widget-title">\n        Widget-Title & Info\n</div>\n    <button type="button" class="btn btn-danger remove-widget-button" id="removeWidgetButton">X</button>\n    </div>\n    <canvas id="templateWidgetCanvas" width="350" height="280"></canvas>\n    <div class="widget-footer">\n    <div class="lastUpdate" id="templateWidgetLastUpdate">\n    </div>\n    <button class="btn btn-sm btn-default configureWidgetButton" id="configureWidgetButton" aria-label="Settings">\n    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\n    </button>\n    </div>\n    </div>',D=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T||(T=this,b=0,f=new i.GaugeWidgetFactory(this),g=new r.LineGraphWidgetFactory(this),h=new c.BarGraphWidgetFactory(this),v=new o.MapWidgetFactory(this),_=new s.PlainDataWidgetFactory(this),y=new l.PlainTextWidgetFactory(this),p=new u.ThermometerWidgetFactory(this),m=new d.TrafficLightWidgetFactory(this)),T}return n(e,[{key:"createWidget",value:function(e,t){var a=b++,n="";switch(e){case WIDGET_TYPE_GAUGE:n=f.create(a,t,w);break;case WIDGET_TYPE_LINEGRAPH:n=g.create(a,t,w);break;case WIDGET_TYPE_BARGRAPH:n=h.create(a,t,w);break;case WIDGET_TYPE_MAP:n=v.create(a,t);break;case WIDGET_TYPE_PLAINDATA:n=_.create(a,t);break;case WIDGET_TYPE_PLAINTEXT:n=y.create(a,t);break;case WIDGET_TYPE_THERMOMETER:n=p.create(a,t,w);break;case WIDGET_TYPE_TRAFFICLIGHT:n=m.create(a,t);break;default:return alert("This type is yet to be implemented."),-1}return[a,n]}},{key:"getCurrentTimePretty",value:function(){for(var e=new Date,t=[e.getHours(),e.getMinutes(),e.getSeconds()],a=0;a<t.length;a++)t[a]<10&&(t[a]="0"+t[a]);return t[0]+":"+t[1]+":"+t[2]}},{key:"getTimePretty",value:function(e){function t(e){return e<10?"0"+e:""+e}var a=window.iotlg.dateFormat;return a=a.replace("yyyy",e.getFullYear()).replace("mm",t(e.getMonth()+1)).replace("dd",t(e.getDate())).replace("hh",t(e.getHours())).replace("MM",t(e.getMinutes())).replace("ss",t(e.getSeconds()))}}]),e}();t.WidgetFactory=D},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=a(4),s=null,l=null,u=null,d=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s||(s=this,l=t,u=new i.UserEvents),s}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){var t=[];for(var a in e.data)t.push(e.data[a].data);return 1==t.length?t[0]:t})}:t[a]=e[a];return t}},{key:"create",value:function(e,t,a){var n=this,i=$("<div/>").prepend(a),d="iotdbWidget"+e,c="#"+d;return $("#templateWidgetCanvas").ready(function(){$("#templateWidget").attr("id",d),$("#templateWidgetLastUpdate").attr("id",d+"-lastUpdate"),$("#templateWidgetCanvas").attr("id",d+"-canvas"),$("#"+d).parent().resize(function(){s._resizeCanvas(d)}),$(c).find(".widget-title").text(window.iotlg.widgetGaugeTitle),$(c).find("#removeWidgetButton").click(function(){u.removeWidget(d)}),$(c).find("#configureWidgetButton").click(function(){u.configureWidget(d)});var e=new RGraph.Gauge({id:d+"-canvas",min:0,max:100,value:0,options:{anglesStart:RGraph.PI-RGraph.PI/8,anglesEnd:RGraph.TWOPI+RGraph.PI/8,shadow:!1,textColor:"#FFFFFF",tickmarksBigColor:"#FFFFFF",tickmarksMediumColor:"#FFFFFF",tickmarksSmallColor:"#FFFFFF",colorsRanges:[],backgroundColor:"#000000",borderInner:"#000000",borderOuter:"#000000",borderOutline:"#000000",needleColors:["#FF0000"],needleType:"line",needleTail:!0,centerpinRadius:.1,titleTop:"",titleTopSize:12,titleTopColor:"#FFFFFF",titleBottom:"",titleBottomColor:"#FFFFFF",titleBottomSize:12,labelsCentered:!0,labelsOffset:7,textAccessible:!0,initialConfig:!0}}).draw(),a=$("#"+d+"-lastUpdate")[0],f=function(t){t=n._formatConfigurableData(t),i.find(".widget-title")[0].innerText=t.title.data,RGraph.reset(document.getElementById(d+"-canvas")),e=new RGraph.Gauge({id:d+"-canvas",min:t.min.data,max:t.max.data,value:e?e.value:7,options:{anglesStart:RGraph.PI-RGraph.PI/8,anglesEnd:RGraph.TWOPI+RGraph.PI/8,shadow:t.shadow.data,textColor:t.textColor.data,tickmarksBigColor:t.tickmarksBigColor.data,tickmarksMediumColor:t.tickmarksMediumColor.data,tickmarksSmallColor:t.tickmarksSmallColor.data,colorsRanges:t.colorsRanges.data,backgroundColor:t.backgroundColor.data,borderInner:t.borderInnerColor.data,borderOuter:t.borderOuterColor.data,borderOutline:t.borderOutlineColor.data,needleColors:[t.needleColor.data],needleType:t.needleType.data,needleTail:t.needleTail.data,centerpinRadius:t.centerpinRadius.data,titleTop:t.titleTop.data,titleTopSize:t.titleTopSize.data,titleTopColor:t.titleTopColor.data,titleBottom:t.titleBottom.data,titleBottomColor:t.titleBottomColor.data,titleBottomSize:t.titleBottomSize.data,labelsCentered:t.labelsCentered.data,labelsOffset:t.labelsOffset.data,textAccessible:t.textAccessible.data}}).draw()};t(d,function(t){if(void 0!==t.Observations){var n=(new o.WidgetConfig).getWidgetDataByID(d).configurableData;""==n.titleTop.data&&(n.titleTop={data:t.DataStream_name,type:TYPE_STRING}),""==n.titleBottom.data&&t.DataStream_unitOfMeasurement&&(n.titleBottom={data:"("+t.DataStream_unitOfMeasurement.symbol+")",type:TYPE_STRING},f(n)),t.DataStream_unitOfMeasurement&&(n.titleBottom.data=t.DataStream_unitOfMeasurement.symbol),new Date,a.innerText=window.iotlg.widgetLastUpdate+": "+l.getCurrentTimePretty();var i=void 0,s=0;for(var u in t.Observations)new Date(t.Observations[u].Observation_phenomenonTime).getTime()>s&&(s=new Date(t.Observations[u].Observation_phenomenonTime).getTime(),i=t.Observations[u].Observation_result,console.log("Value: ",i));e.value=i,e.grow({frames:10})}var c=new r.View;c.getLoadingWidgets().indexOf(d)>-1&&c.popLoading(d)},f),s._resizeCanvas(d)}),i}},{key:"_resizeCanvas",value:function(e){var t=$("#"+e+"-canvas"),a=t.parent().width(),n=t.parent().height();t.attr("width",a),t.attr("height",n),RGraph.Clear(t[0]),RGraph.Redraw()}}]),e}();t.GaugeWidgetFactory=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=null,s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,s=t,l=new i.UserEvents),o}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"_formatDate",value:function(e,t){var a=window.iotlg.dateFormat,n=new Date;n.setTime(e.getTime()+this._getMilliseconds(t,UNIT_HOUR));var i=n.getUTCHours(),r=n.getUTCDate();return a=(a=(a=(a=(a=(a=(a=a.replace("yyyy",n.getUTCFullYear())).replace("mm",this._fillUp(n.getUTCMonth()+1,2))).replace("dd",this._fillUp(r,2))).replace("hh",this._fillUp(i,2))).replace("MM",this._fillUp(n.getUTCMinutes(),2))).replace("ss",this._fillUp(n.getUTCSeconds(),2))).replace(" ","\n")}},{key:"_fillUp",value:function(e,t){return(""+e).length<t?this._fillUp("0"+e,t-1):e}},{key:"_sortByFirstValue",value:function(e,t){return e[0]===t[0]?0:new Date(e[0])<new Date(t[0])?-1:1}},{key:"_sortBySecondValue",value:function(e,t){return e[1]===t[1]?0:new Date(e[1])<new Date(t[1])?-1:1}},{key:"_calcBiggestTimeUnitDifference",value:function(e,t){var a=Math.abs(t.getTime()-e.getTime()),n=e,i=t;return n>t&&(n=t,i=e),a<1e3?{unit:UNIT_MILLISECOND,difference:a,startDate:n,endDate:i}:Math.ceil(a/1e3<60)?{unit:UNIT_SECOND,difference:a,startDate:n,endDate:i}:Math.ceil(a/6e4<60)?{unit:UNIT_MINUTE,difference:a,startDate:n,endDate:i}:Math.ceil(a/36e5<24)?{unit:UNIT_HOUR,difference:a,startDate:n,endDate:i}:Math.ceil(a/864e5<31)?{unit:UNIT_DAY,difference:a,startDate:n,endDate:i}:Math.ceil(a/864e5<365)?{unit:UNIT_MONTH,difference:a,startDate:n,endDate:i}:{unit:UNIT_YEAR,difference:a,startDate:n,endDate:i}}},{key:"_getMilliseconds",value:function(e,t){switch(t){case UNIT_MILLISECOND:return e;case UNIT_SECOND:return 1e3*e;case UNIT_MINUTE:return 1e3*e*60;case UNIT_HOUR:return 1e3*e*60*60;case UNIT_DAY:return 1e3*e*60*60*24;case UNIT_MONTH:return 1e3*e*60*60*24*31;case UNIT_YEAR:return 1e3*e*60*60*24*365;default:return console.error("Error, unknown unit constant"),e}}},{key:"_calcLabelTicks",value:function(e,t,a){for(var n=-Math.ceil((new Date).getTimezoneOffset()/60),i=this._calcBiggestTimeUnitDifference(e,t),r=Math.ceil(i.difference/a),o=[],s=0;s<a-1;s++)o.push([this._formatDate(new Date(i.startDate.getTime()+r*s),n),new Date(i.startDate.getTime()+r*s).toUTCString()]);return o.push([this._formatDate(new Date(i.endDate.getTime()),n),new Date(i.endDate.getTime()).toUTCString()]),{label:o,interval:r,startDate:i.startDate,endDate:i.endDate}}},{key:"_convertedDataToSccatterData",value:function(e,t){for(var a=[],n=0;n<e.length;n++)if(a.push([]),void 0!==e[n].Observations){for(var i=0;i<e[n].Observations.length;i++)a[n].push([new Date(e[n].Observations[i].Observation_phenomenonTime).toUTCString(),e[n].Observations[i].Observation_result,t]);a[n].sort(this._sortByFirstValue)}return a}},{key:"_trimData",value:function(e,t,a){for(var n=[],i=0;i<a.length;i++)n.push(a[i].filter(function(a){return new Date(a[0])>=e&&new Date(a[0])<=t}));return n}},{key:"_getRelativMinAndMax",value:function(e,t){var a=new Date,n=new Date,i=[];return e.forEach(function(e){e.length>=2&&i.push([e[0][0],e[e.length-1][0]]),1==e.length&&i.push([e[0][0],e[0][0]])}),a=new Date(i.sort(this._sortByFirstValue)[0][0]),(n=new Date(i.sort(this._sortBySecondValue)[i.length-1][1]))>new Date&&(n=new Date),n.getTime()-a.getTime()>t&&a.setTime(n.getTime()-t),{min:a,max:n}}},{key:"create",value:function(e,t,a){var n=this,i=$("<div/>").prepend(a),u="iotdbWidget"+e,d="#"+u;return $("#templateWidgetCanvas").ready(function(){$("#templateWidget").attr("id",u),$("#templateWidgetLastUpdate").attr("id",u+"-lastUpdate"),$("#templateWidgetCanvas").attr("id",u+"-canvas"),$("#"+u).parent().resize(function(){o._resizeCanvas(u)}),$(d).find(".widget-title").text(window.iotlg.widgetLineGraphTitle),$(d).find("#removeWidgetButton").click(function(){l.removeWidget(u)}),$(d).find("#configureWidgetButton").click(function(){l.configureWidget(u)});var e=void 0,a=[[[0,0,"white"]]],c=void 0,f=void 0,g=4,h=void 0,v=void 0,p={label:""},_=$("#"+u+"-lastUpdate")[0];t(u,function(t){if(void 0!=t[0]&&void 0!=t[0].Observations){if(a=n._convertedDataToSccatterData(t,h),e){var i=n._getRelativMinAndMax(a,c);v.xmin=i.min.toUTCString(),v.xmax=i.max.toUTCString()}a=n._trimData(new Date(v.xmin),new Date(v.xmax),a),_.innerText=window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty();var o=n._calcLabelTicks(new Date(v.xmin),new Date(v.xmax),g);v.backgroundGridAutofitNumvlines=o.label.length,v.labels=o.label,RGraph.reset(document.getElementById(u+"-canvas")),new RGraph.Scatter({id:u+"-canvas",data:a,options:v}).draw()}var l=new r.View("id");l.getLoadingWidgets().indexOf(u)>=0&&l.popLoading(u)},function(t){t=n._formatConfigurableData(t),i.find(".widget-title")[0].innerText=t.title.data,e=t.timeIntervalRelative.data,f=t.timeIntervalUnit.data;var r=t.endTime.data.toUTCString(),o=t.startTime.data.toUTCString();if(c=n._getMilliseconds(t.timeInterval.data,f),a.length>=1){if(e){var s=n._getRelativMinAndMax(a,c);o=s.min.toUTCString(),r=s.max.toUTCString()}g=t.labelSteps.data,p=n._calcLabelTicks(new Date(o),new Date(r),g)}void 0===t.ymin&&(t.ymin={data:0,type:0}),h=t.pointColor.data,v={xmin:o,xmax:r,ymin:t.ymin.data,backgroundGridBorder:t.backgroundGridBorder.data,backgroundGridVlines:t.backgroundGridVlines.data,backgroundBarcolor1:t.backgroundBarcolor1.data,backgroundBarcolor2:t.backgroundBarcolor2.data,backgroundGridColor:t.backgroundGridColor.data,gutterLeft:50,gutterBottom:85,tickmarks:t.tickmarks.data,labels:p.label,noxaxis:!0,textAngle:45,backgroundGridAutofitNumvlines:p.label.length,ticksize:t.ticksize.data,line:t.line.data,lineColors:t.lineColors.data,titleXaxis:t.titleXaxis.data,titleXaxisPos:.1,titleYaxis:t.titleYaxis.data,titleYaxisPos:.15},RGraph.reset(document.getElementById(u+"-canvas")),new RGraph.Scatter({id:u+"-canvas",data:a,options:v}).draw()}),o._resizeCanvas(u)}),i}},{key:"_resizeCanvas",value:function(e){var t=$("#"+e+"-canvas"),a=t.parent().width(),n=t.parent().height();t.attr("width",a),t.attr("height",n),RGraph.Clear(t[0]),RGraph.Redraw()}}]),e}();t.LineGraphWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=null,s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,s=t,l=new i.UserEvents,this.mapLayers=L.layerGroup(),this.mapIDs=[]),o}return n(e,[{key:"getMapLayers",value:function(){return this.mapLayers.getLayers()}},{key:"removeLayerGroup",value:function(e){for(var t in this.mapIDs)this.mapIDs[t].mapID==e&&this.mapLayers.removeLayer(this.mapIDs[t].layerID)}},{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){return e.data})}:t[a]=e[a];return t}},{key:"_sortByTime",value:function(e,t){return e.time===t.time?0:e.time<t.time?-1:1}},{key:"create",value:function(e,t){var a=this,n=$("<div/>").prepend('<div id="mapWidget" class="grid-stack-item-content">\n        <div class="widget-header">\n        <div class="widget-title">\n        Widget-Title & Info\n</div>\n    <button type="button" class="btn btn-danger remove-widget-button" id="removeWidgetButton">X</button>\n    </div>\n    <div id="mapWidgetDiv" class="mapWidgets"></div>\n    <div class="widget-footer map-footer">\n    <div class="lastUpdate" id="templateWidgetLastUpdate">\n    </div>\n    <button class="btn btn-sm btn-default configureWidgetButton" id="configureWidgetButton" aria-label="Settings">\n    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\n    </button>\n    </div>\n    </div>'),i="iotdbWidget"+e,o="#"+i;return $("#mapWidgetDiv").ready(function(){$("#mapWidget").attr("id",i),$("#templateWidgetLastUpdate").attr("id",i+"-lastUpdate"),$("#mapWidgetDiv").attr("id",i+"-div"),$(o).find(".widget-title").text(window.iotlg.widgetMapTitle),$(o).find("#removeWidgetButton").click(function(){l.removeWidget(i)}),$(o).find("#configureWidgetButton").click(function(){l.configureWidget(i)}),L.Icon.Default.imagePath=window.iotBaseDir+"res/LeafletImages/";var e=$("#"+i+"-lastUpdate")[0],u=L.map(i+"-div").setView([49.014,8.404],13);$("#"+i).parent().resize(function(){return setTimeout(function(){u.invalidateSize()},200)}),u.dragging.disable(),u.on("popupopen",function(e){});var d=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoidmV4dXJ5IiwiYSI6ImNpd3R2ZzY5djAwbzcydXFyazRsam80cDAifQ.TaIW3pR4RS3UuyZg61HV6g",{attribution:"Map data &copy; <a href='http://openstreetmap.org'>OpenStreetMap</a> contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/'>CC-BY-SA</a>, Imagery © <a href='http://mapbox.com'>Mapbox</a>"});d.addTo(u);var c=[],f=[],g=L.geoJSON().addTo(u);a.mapLayers.addLayer(g),a.mapIDs.push({mapID:i,layerID:a.mapLayers.getLayerId(g)});var h=L.icon({iconUrl:window.iotBaseDir+"res/TLgreen.svg",iconSize:[15,35]}),v=L.icon({iconUrl:window.iotBaseDir+"res/TLred.svg",iconSize:[15,35]}),p=L.icon({iconUrl:window.iotBaseDir+"res/TLyellow.svg",iconSize:[15,35]});t(i,function(t){g.clearLayers(),e.innerText=window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty();for(var n=0;n<t.length;n++)if(void 0!==t[n].Thing_Locations)if("application/vnd.geo+json"!==t[n].Thing_Locations[t[n].Thing_Locations.length-1].encodingType)console.error("Error, encoding type is not geoJSON");else{var o=void 0,l=void 0;void 0!==c[n]&&(l=c[n]);var u=void 0,d=void 0;switch(l){case MARKER_TYPE_PLAIN:o=t[n].Thing_Locations[t[n].Thing_Locations.length-1].location,g.addData(o);break;case MARKER_TYPE_PLAINVALUE:if(void 0==t[n].Observations)break;o=t[n].Thing_Locations[t[n].Thing_Locations.length-1].location;var _=t[n].DataStream_unitOfMeasurement.symbol;for(var y in d=0,t[n].Observations)new Date(t[n].Observations[y].Observation_phenomenonTime).getTime()>d&&(d=new Date(t[n].Observations[y].Observation_phenomenonTime).getTime(),u=t[n].Observations[y].Observation_result);var m=u.toString(),T=void 0;T=void 0!==_?L.popup({autoPan:!1,autoClose:!1}).setContent("<center>"+m.toString()+" "+_+"</center>"):L.popup({autoPan:!1,autoClose:!1}).setContent("<center>"+m.toString()+"</center>"),(O=L.GeoJSON.geometryToLayer(o)).bindPopup(T).addTo(g).openPopup();break;case MARKER_TYPE_TRAFFICLIGHT:if(void 0==t[n].Observations)break;o=t[n].Thing_Locations[t[n].Thing_Locations.length-1].location;var b=void 0;for(var y in d=0,t[n].Observations)new Date(t[n].Observations[y].Observation_phenomenonTime).getTime()>d&&(d=new Date(t[n].Observations[y].Observation_phenomenonTime).getTime(),u=t[n].Observations[y].Observation_result);var w=u,D=function(e){switch(e){case COLOR_RED:return v;case COLOR_YELLOW:return p;case COLOR_GREEN:default:return h}};b=w<f[n].middle?D(f[n].lowerColor):w<=f[n].upper?D(f[n].middleColor):D(f[n].upperColor);var O=L.GeoJSON.geometryToLayer(o);O.setIcon(b).addTo(g);break;case MARKER_TYPE_HISTORY:var k=t[n].Thing_HistoricalLocations;k.sort(a._sortByTime);for(var C=[],E=0;E<k.length;E++)if(k[E].hasOwnProperty("Locations"))for(var P=0;P<k[E].Locations.length;P++)C.push(L.GeoJSON.geometryToLayer(k[E].Locations[P].location).getLatLng());L.polyline(C,{color:"red"}).addTo(g)}}var I=new r.View;I.getLoadingWidgets().indexOf(i)>=0&&I.popLoading(i)},function(e){e=a._formatConfigurableData(e),n.find(".widget-title")[0].innerText=e.title.data,u.setView(L.latLng(e.latitude.data,e.longitude.data),e.zoom.data),u.removeLayer(d),d=L.tileLayer(e.mapURL.data,{attribution:e.attribution.data}).addTo(u);for(var t=0;t<e.sensorThingsConfiguration.data.length;t++){c[t]=e.sensorThingsConfiguration.data[t].overlayType.data;var i=e.sensorThingsConfiguration.data[t].thresholdMiddle.data,r=e.sensorThingsConfiguration.data[t].thresholdUpper.data,o=e.sensorThingsConfiguration.data[t].lowerRangeColor.data,s=e.sensorThingsConfiguration.data[t].middleRangeColor.data,l=e.sensorThingsConfiguration.data[t].upperRangeColor.data;f[t]={middle:i,upper:r,lowerColor:o,middleColor:s,upperColor:l}}})}),n}}]),e}();t.MapWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=null,s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,l=new i.UserEvents,s=t),o}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"create",value:function(e,t){var a=this,n=$("<div/>").prepend('\n        <div id="templateWidget" class="grid-stack-item-content">\n        <div class="widget-header">\n        <div class="widget-title">\n        Widget-Title & Info\n</div>\n    <button type="button" class="btn btn-danger remove-widget-button" id="removeWidgetButton">X</button>\n    </div>\n    <div class="widget-footer">\n    <div class="lastUpdate" id="templateWidgetLastUpdate">\n    </div>\n    <button class="btn btn-sm btn-default configureWidgetButton" id="configureWidgetButton" aria-label="Settings">\n    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\n    </button>\n    </div>\n    </div>');return $("#templateWidgetCanvas").ready(function(){var i="iotdbWidget"+e,o="#"+i;n.find("#templateWidget").attr("id",i),n.find("#templateWidgetLastUpdate").attr("id",i+"-lastUpdate");var u=document.createElement("DIV");u.className="widget-text-container";var d=document.createElement("SPAN");d.className="widget-text-element",d.id=i+"-textElement",u.appendChild(d);var c=document.createElement("SPAN");c.className="widget-unit-element",c.id=i+"-unitElement",u.appendChild(c),d.style.fontSize="27px",c.style.fontSize="22px",n.find("#"+i)[0].insertBefore(u,n.find(".widget-footer")[0]),n.find(o).find(".widget-title").text(window.iotlg.widgetPlainTextTitle),n.find(o).find("#removeWidgetButton").click(function(){l.removeWidget(i)}),n.find(o).find("#configureWidgetButton").click(function(){l.configureWidget(i)});t(i,function(e){if(void 0!==e.Observations){new Date;var t=void 0,a=0;for(var n in e.Observations)new Date(e.Observations[n].Observation_phenomenonTime).getTime()>a&&(a=new Date(e.Observations[n].Observation_phenomenonTime).getTime(),t=e.Observations[n].Observation_result);$(o).find("#"+i+"-lastUpdate").text(window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty()),$(o).find(".widget-text-element").text(t.toString())}var l=new r.View("id");l.getLoadingWidgets().indexOf(i)>=0&&l.popLoading(i)},function(e){e=a._formatConfigurableData(e),$(o).find(".widget-title").text(e.title.data),$(o).find("#"+i+"-textElement").css("font-size",e.valueSize.data.toString()+"px"),$(o).find("#"+i+"-unitElement").css("font-size",e.unitSize.data.toString()+"px"),$(o).find("#"+i+"-unitElement").text(e.unit.data)})}),n}}]),e}();t.PlainDataWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=null,o=null,s=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r||(r=this,o=new i.UserEvents),r}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"create",value:function(e,t){var a=this,n=$("<div/>").prepend('\n        <div id="templateWidget" class="grid-stack-item-content">\n        <div class="widget-header">\n        <div class="widget-title">\n        Widget-Title & Info\n</div>\n    <button type="button" class="btn btn-danger remove-widget-button" id="removeWidgetButton">X</button>\n    </div>\n    <div class="widget-footer">\n    <button class="btn btn-sm btn-default configureWidgetButton" id="configureWidgetButton" aria-label="Settings">\n    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\n    </button>\n    </div>\n    </div>'),i="iotdbWidget"+e,r="#"+i;return $("#templateWidgetCanvas").ready(function(){n.find("#templateWidget").attr("id",i);var e=document.createElement("DIV");e.className="widget-text-container";var s=document.createElement("SPAN");s.className="widget-text-element",s.id=i+"-textElement",e.appendChild(s),s.innerText=window.iotlg.textWidgetDefaultText,e.style.fontSize="27px",n.find("#"+i)[0].insertBefore(e,n.find(".widget-footer")[0]),n.find(r).find(".widget-title").text(window.iotlg.widgetPlainTextTitle),n.find(r).find("#removeWidgetButton").click(function(){o.removeWidget(i)}),n.find(r).find("#configureWidgetButton").click(function(){o.configureWidget(i)});t(i,null,function(e){e=a._formatConfigurableData(e),$(r).find(".widget-text-element").text(e.text.data),$(r).find(".widget-title").text(e.title.data),$(r).find(".widget-text-element").css("font-size",e.fontSize.data.toString()+"px")})}),n}}]),e}();t.PlainTextWidgetFactory=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=(a(4),null),s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,s=t,l=new i.UserEvents),o}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"_correctScaleDecimals",value:function(e){return e=(e=e<0?0:e)>20?20:e}},{key:"create",value:function(e,t,a){var n=this,i=$("<div/>").prepend(a),u="iotdbWidget"+e,d="#"+u,c={scaleVisible:!0,scaleDecimals:2,gutterLeft:60,gutterRight:60,valueLabel:!1};return $("#templateWidgetCanvas").ready(function(){$("#templateWidget").attr("id",u),$("#templateWidgetLastUpdate").attr("id",u+"-lastUpdate"),$("#templateWidgetCanvas").attr("width",160),$("#templateWidgetCanvas").attr("id",u+"-canvas"),$("#"+u).parent().resize(function(){o._resizeCanvas(u)}),$(d).find(".widget-title").text(window.iotlg.widgetThermometerTitle),$(d).find("#removeWidgetButton").click(function(){l.removeWidget(u)}),$(d).find("#configureWidgetButton").click(function(){l.configureWidget(u)});var e=void 0;e=new RGraph.Thermometer({id:u+"-canvas",min:0,max:100,value:7,options:c}).draw();var a=$("#"+u+"-lastUpdate")[0];t(u,function(t){void 0!=t&&void 0!=t.Observations&&function(){new Date,a.innerText=window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty();var n=void 0,i=0;t.Observations.forEach(function(e){new Date(e.Observation_phenomenonTime).getTime()>i&&(i=new Date(e.Observation_phenomenonTime).getTime(),n=e.Observation_result)}),n&&(void 0==e?(RGraph.reset(document.getElementById(u+"-canvas")),e=new RGraph.Thermometer({id:u+"-canvas",min:0,max:100,value:n,options:c}).draw()):(e.value=n,e.grow({frames:10})))}();var n=new r.View("id");n.getLoadingWidgets().indexOf(u)>=0&&n.popLoading(u)},function(t){t=n._formatConfigurableData(t),i.find(".widget-title")[0].innerText=t.title.data,t.scaleDecimals.data=n._correctScaleDecimals(t.scaleDecimals.data),c={scaleVisible:t.scaleVisible.data,scaleDecimals:t.scaleDecimals.data,gutterLeft:t.gutterLeft.data,gutterRight:t.gutterRight.data,valueLabel:t.valueLabel.data,titleSide:t.titleSide?t.titleSide.data:""},RGraph.reset(document.getElementById(u+"-canvas")),e=new RGraph.Thermometer({id:u+"-canvas",min:t.min.data,max:t.max.data,value:0,options:c}).draw()}),o._resizeCanvas(u)}),i}},{key:"_resizeCanvas",value:function(e){var t=$("#"+e+"-canvas");t.parent().css("margin-left","5%");var a=t.parent().width(),n=t.parent().height();1*n/a>3?n=3*a:1*n/a<2.5&&(a=Math.max(n/2.5,170),a=Math.min(a,280)),t.attr("width",a),t.attr("height",n),t.parent().css("margin-left",.5*(t.parent().width()-a)),RGraph.Clear(t[0]),RGraph.Redraw()}}]),e}();t.ThermometerWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=null,s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,s=t,l=new i.UserEvents),o}return n(e,[{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"create",value:function(e,t){var a=this,n=$("<div/>").prepend('\n        <div id="templateWidget" class="grid-stack-item-content">\n        <div class="widget-header">\n        <div class="widget-title">\n        Widget-Title & Info\n</div>\n    <button type="button" class="btn btn-danger remove-widget-button" id="removeWidgetButton">X</button>\n    </div>\n    <div class="widget-footer">\n    <div class="lastUpdate" id="templateWidgetLastUpdate">\n    </div>\n    <button class="btn btn-sm btn-default configureWidgetButton" id="configureWidgetButton" aria-label="Settings">\n    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\n    </button>\n    </div>\n    </div>'),i="iotdbWidget"+e,o="#"+i;return $("#templateWidgetCanvas").ready(function(){var e={};n.find("#templateWidget").attr("id",i),n.find("#templateWidgetLastUpdate").attr("id",i+"-lastUpdate");var u=document.createElement("DIV");u.className="traffic-light",u.style.backgroundImage="url('"+window.iotBaseDir+"res/TLred.svg')",n.find("#"+i)[0].insertBefore(u,n.find(".widget-footer")[0]),$(o).find(".widget-title").text(window.iotlg.widgetTrafficLightTitle),n.find(o).find("#removeWidgetButton").click(function(){l.removeWidget(i)}),n.find(o).find("#configureWidgetButton").click(function(){l.configureWidget(i)});var d=n.find("#"+i+"-lastUpdate")[0],c=function(t){t=this._formatConfigurableData(t),$(o).find(".widget-title").text(t.title.data),e.lowerThreshold=t.lower.data,e.upperThreshold=t.upper.data,e.lowerColor=t.lowerColor.data,e.middleColor=t.middleColor.data,e.upperColor=t.upperColor.data}.bind(a);t(i,function(t){$("#"+i+".traffic-light")[0],new Date;if(d.innerText=window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty(),t.Observations){var a=void 0,n=0;for(var o in t.Observations)new Date(t.Observations[o].Observation_phenomenonTime).getTime()>n&&(n=new Date(t.Observations[o].Observation_phenomenonTime).getTime(),a=t.Observations[o].Observation_result);var l=function(e){switch(e){case COLOR_RED:return"red";case COLOR_YELLOW:return"yellow";case COLOR_GREEN:default:return"green"}},u=void 0;u=a<e.lowerThreshold?l(e.lowerColor):a<=e.upperThreshold?l(e.middleColor):l(e.upperColor),$("#"+i+" .traffic-light").css("background-image","url('"+window.iotBaseDir+"res/TL"+u+".svg')");var c=new r.View("id");c.getLoadingWidgets().indexOf(i)>=0&&c.popLoading(i)}},c)}),n}}]),e}();t.TrafficLightWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=a(6),o=(a(4),null),s=null,l=null,u=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,s=t,l=new i.UserEvents),o}return n(e,[{key:"_formatDate",value:function(e,t){var a=window.iotlg.dateFormat,n=new Date;n.setTime(e.getTime()+this._getMilliseconds(t,UNIT_HOUR));var i=n.getUTCHours(),r=n.getUTCDate();return a=(a=(a=(a=(a=(a=(a=a.replace("yyyy",n.getUTCFullYear())).replace("mm",this._fillUp(n.getUTCMonth()+1,2))).replace("dd",this._fillUp(r,2))).replace("hh",this._fillUp(i,2))).replace("MM",this._fillUp(n.getUTCMinutes(),2))).replace("ss",this._fillUp(n.getUTCSeconds(),2))).replace(" ","\n")}},{key:"_fillUp",value:function(e,t){return(""+e).length<t?this._fillUp("0"+e,t-1):e}},{key:"_formatConfigurableData",value:function(e){var t={};for(var a in e)e[a].type==TYPE_ARRAY?t[a]={data:e[a].data.map(function(e){for(var t in e.data)return e.data[t].data})}:t[a]=e[a];return t}},{key:"_fillUp",value:function(e,t){return(""+e).length<t?this._fillUp("0"+e,t-1):e}},{key:"_sortByFirstValue",value:function(e,t){return e[0]===t[0]?0:new Date(e[0])<new Date(t[0])?-1:1}},{key:"_sortBySecondValue",value:function(e,t){return e[1]===t[1]?0:new Date(e[1])<new Date(t[1])?-1:1}},{key:"_calcBiggestTimeUnitDifference",value:function(e,t){var a=Math.abs(t.getTime()-e.getTime()),n=e,i=t;return n>t&&(n=t,i=e),a<1e3?{unit:UNIT_MILLISECOND,difference:a,startDate:n,endDate:i}:Math.ceil(a/1e3<60)?{unit:UNIT_SECOND,difference:a,startDate:n,endDate:i}:Math.ceil(a/6e4<60)?{unit:UNIT_MINUTE,difference:a,startDate:n,endDate:i}:Math.ceil(a/36e5<24)?{unit:UNIT_HOUR,difference:a,startDate:n,endDate:i}:Math.ceil(a/864e5<31)?{unit:UNIT_DAY,difference:a,startDate:n,endDate:i}:Math.ceil(a/864e5<365)?{unit:UNIT_MONTH,difference:a,startDate:n,endDate:i}:{unit:UNIT_YEAR,difference:a,startDate:n,endDate:i}}},{key:"_getMilliseconds",value:function(e,t){switch(t){case UNIT_MILLISECOND:return e;case UNIT_SECOND:return 1e3*e;case UNIT_MINUTE:return 1e3*e*60;case UNIT_HOUR:return 1e3*e*60*60;case UNIT_DAY:return 1e3*e*60*60*24;case UNIT_MONTH:return 1e3*e*60*60*24*31;case UNIT_YEAR:return 1e3*e*60*60*24*365;default:return console.error("Error, unknown unit constant"),e}}},{key:"_calcLabelTicks",value:function(e,t,a){for(var n=-Math.ceil((new Date).getTimezoneOffset()/60),i=this._calcBiggestTimeUnitDifference(e,t),r=Math.ceil(i.difference/a),o=[],s=0;s<a-1;s++)o.push(this._formatDate(new Date(i.startDate.getTime()+r*s),n)+"\n - \n"+this._formatDate(new Date(i.startDate.getTime()+r*(s+1)),n));return o.push(this._formatDate(new Date(i.startDate.getTime()+r*(a-1)),n)+"\n - \n"+this._formatDate(new Date(i.endDate.getTime()),n)),{label:o,interval:r,startDate:i.startDate,endDate:i.endDate}}},{key:"_calcMeanFromArray",value:function(e){var t=0,a=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){t+=r.value}}catch(e){n=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}return 0==e.length?t:t/e.length}},{key:"_convertedDataToBarData",value:function(e){for(var t=[],a=0;a<e.length;a++)if(t.push([]),void 0!==e[a].Observations){for(var n=0;n<e[a].Observations.length;n++)t[a].push([new Date(e[a].Observations[n].Observation_phenomenonTime).toUTCString(),e[a].Observations[n].Observation_result]);t[a].sort(this._sortByFirstValue)}return t}},{key:"_trimData",value:function(e,t,a){for(var n=[],i=0;i<a.length;i++)n.push(a[i].filter(function(a){return new Date(a[0])>=e&&new Date(a[0])<=t}));return n}},{key:"_getRelativMinAndMax",value:function(e,t){var a=new Date,n=new Date,i=[];return e.forEach(function(e){e.length>=2?i.push([e[0][0],e[e.length-1][0]]):1==e.length&&i.push([e[0][0],e[0][0]])}),a=new Date(i.sort(this._sortByFirstValue)[0][0]),(n=new Date(i.sort(this._sortBySecondValue)[i.length-1][1]))>new Date&&(n=new Date),n.getTime()-a.getTime()>t&&a.setTime(n.getTime()-t),{min:a,max:n}}},{key:"_groupData",value:function(e,t,a){for(var n=[],i=0;i<t;i++){n.push([]);var r=!0,o=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){for(var d=l.value,c=[],f=0;f<d.length&&new Date(d[f][0])<new Date(a.startDate.getTime()+a.interval*(i+1));f++)new Date(d[f][0])>=new Date(a.startDate.getTime()+a.interval*i)&&c.push(d[f][1]);n[i].push(this._calcMeanFromArray(c))}}catch(e){o=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw s}}}return n}},{key:"create",value:function(e,t,a){var n=this,i=$("<div/>").prepend(a),u="iotdbWidget"+e,d="#"+u;return $("#templateWidgetCanvas").ready(function(){$("#templateWidget").attr("id",u),$("#templateWidgetLastUpdate").attr("id",u+"-lastUpdate"),$("#templateWidgetCanvas").attr("id",u+"-canvas"),$("#"+u).parent().resize(function(){o._resizeCanvas(u)}),$(d).find(".widget-title").text(window.iotlg.widgetBarGraphTitle),$(d).find("#removeWidgetButton").click(function(){l.removeWidget(u)}),$(d).find("#configureWidgetButton").click(function(){l.configureWidget(u)});var e=void 0,a=[[]],c=void 0,f=void 0,g=[],h=void 0,v=void 0,p=void 0,_=3,y={label:""},m=$("#"+u+"-lastUpdate")[0];t(u,function(t){if(void 0!=t[0]&&void 0!=t[0].Observations){if(new Date,m.innerText=window.iotlg.widgetLastUpdate+": "+s.getCurrentTimePretty(),g=n._convertedDataToBarData(t),e){var i=n._getRelativMinAndMax(g,c);p.xmin=i.min.toUTCString(),p.xmax=i.max.toUTCString()}g=n._trimData(new Date(p.xmin),new Date(p.xmax),g),y=n._calcLabelTicks(new Date(p.xmin),new Date(p.xmax),_),a=n._groupData(g,_,y),p.labels=y.label,RGraph.reset(document.getElementById(u+"-canvas")),new RGraph.Bar({id:u+"-canvas",data:a,options:p}).draw()}var o=new r.View("id");o.getLoadingWidgets().indexOf(u)>=0&&o.popLoading(u)},function(t){if(t=n._formatConfigurableData(t),i.find(".widget-title")[0].innerText=t.title.data,e=t.timeIntervalRelative.data,f=t.timeIntervalUnit.data,v=t.endTime.data.toUTCString(),h=t.startTime.data.toUTCString(),c=n._getMilliseconds(t.timeInterval.data,f),g.length>=1){if(e){var r=n._getRelativMinAndMax(g,c);h=r.min.toUTCString(),v=r.max.toUTCString()}y=n._calcLabelTicks(new Date(h),new Date(v),t.timeGroups.data)}_=t.timeGroups.data,p={xmin:h,xmax:v,gutterLeft:50,colors:t.colors.data,backgroundBarcolor1:t.backgroundBarcolor1.data,backgroundBarcolor2:t.backgroundBarcolor2.data,backgroundGrid:t.backgroundGrid.data,gutterBottom:120,labels:y.label,titleXaxis:"Time intervals",titleXaxisPos:-.1,titleYaxis:t.titleY.data,titleYaxisPos:.15},RGraph.reset(document.getElementById(u+"-canvas")),new RGraph.Bar({id:u+"-canvas",data:a,options:p}).draw()}),o._resizeCanvas(u)}),i}},{key:"_resizeCanvas",value:function(e){var t=$("#"+e+"-canvas"),a=t.parent().width(),n=t.parent().height();t.attr("width",a),t.attr("height",n),RGraph.Clear(t[0]),RGraph.Redraw()}}]),e}();t.BarGraphWidgetFactory=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(20),r=a(6),o=null,s=null,l=null,u=null,d=function(){function e(t){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s||((u=this)._configTableRowFactory=new i.ConfigTableRowFactory,$("#widget_conf_close").click(function(e){return a._toggleView(s)}),$("#widget_conf_save").click(function(e){return a._saveExit()})),l=(o=t).getID(),this.widgetConfigurableData=s=o.getConfigurableData(),this._toggleView(s)}return n(e,[{key:"_saveExit",value:function(){u._createConfigurableData(),-1==[WIDGET_TYPE_PLAINTEXT].indexOf(o.type)&&s.sensorThingsConfiguration.data[0].data.dataStreamUrl.data.length>0&&(new r.View).pushLoading(l),o.setConfigurableData(s),this._toggleView(s)}},{key:"_extractValue",value:function(e,t,a){var n=void 0,i=void 0,r=null;switch($(e).attr("class")){case"widget-config-array-input":null==a[t]&&(a[t]={}),i=TYPE_ARRAY,n=u._getConfArray(e,a[t].data);break;case"widget-config-object-input":null==a&&(a={}),null==a[t]&&(a[t]={}),i=TYPE_OBJECT,n=u._getConfObject(e,a[t].data);break;case"widget-config-item":var o=$(e).find(".widget-config-data");switch($(o).attr("input_fmt")){case"string":i=TYPE_STRING,n=$(o).find(".widget-config-input").val();break;case"int":if(i=TYPE_INTEGER,n=parseInt($(o).find(".widget-config-input").val()),isNaN(n))return{failedAttribute:t};break;case"date":i=TYPE_DATE;var s=$(o).find(".widget-config-input").val();if("Invalid Date"==(n=this._configTableRowFactory._dateAddMinutes(new Date(s+"Z"),(new Date).getTimezoneOffset()))||n<new Date(0))return{failedAttribute:t};break;case"dropdown":i=TYPE_DROPDOWN,n=parseInt($(o).find(".widget-config-input").find("option:selected").val());r={};$(o).find(".widget-config-input").find("option").each(function(){r[$(this).text()]=$(this).val()});break;case"number":if(i=TYPE_NUMBER,n=parseFloat($(o).find(".widget-config-input").val()),isNaN(n))return{failedAttribute:t};break;case"color":if(i=TYPE_COLOR,n=$(o).find(".widget-config-input").val(),!/^#[0-9A-F]{6}$/i.test(n))return{failedAttribute:t};break;case"checkbox":if(i=TYPE_BOOLEAN,"boolean"!=typeof(n=$(o).find(".widget-config-input").prop("checked")))return{failedAttribute:t};break;case"fssearch":i=TYPE_FUZZY_SENSOR_SEARCH,n=$(o).find(".urlBox").val();break;default:i=TYPE_OTHER,console.log("unrecognized: ",$(o),$(o).attr("input_fmt"))}break;default:i=TYPE_OTHER,n=$(e).find(".widget-config-data").find("input").val()}return{value:n,type:i,options:r}}},{key:"_createConfigurableData",value:function(){for(var e=jQuery.extend(!0,{},s),t=$("#widget_conf_table"),a=$(t).children().length,n=0;n<a;n++){var i=$(t).children()[n],r=$(i).find(".widget-conf-label").attr("key-id"),o=this._extractValue(i,r,s,null);if(o.failedAttribute)return alert('Parsing error at attribute "'+o.failedAttribute+'". Saving aborted, old configuration restored.\nPlease verify the current value.'),void(s=e);s[r].data=o.value,s[r].type=o.type}}},{key:"_getConfArray",value:function(e,t){t=[];for(var a=$(e).find("tbody.widget-config-array-table").first(),n=$(a).children().length,i=0;i<n;i++){var r=$(a).children()[i],o=$(r).find(".widget-conf-label").attr("key-id"),s=this._extractValue(r,o,t);if(s.failedAttribute)return s;null==t&&(t=[]),null==t[o]&&(t[o]={}),t[o].data=s.value,t[o].type=s.type,t[o].options=s.options}return t}},{key:"_getConfObject",value:function(e,t){for(var a=$(e).find("tbody.widget-config-object-table").first(),n=a.children().length,i=0;i<n;i++){var r=a.children()[i],o=$(r).find(".widget-conf-label").attr("key-id"),s=this._extractValue(r,o,t);if(s.failedAttribute)return s;null==t&&(t={}),null==t[o]&&(t[o]={}),t[o].data=s.value,t[o].type=s.type,t[o].options=s.options}return t}},{key:"_toggleView",value:function(e){var t=$("div.conf-popup#configureWidget");if(t.hasClass("open"))t.css("animationName","animateOut");else{u._configTableRowFactory.loadDataStreamList(),t.find("#widget_conf_title").text("Configure widget: "+e.title.data);var a=$("#widget_conf_table");for(var n in a.html(""),e)if(e.hasOwnProperty(n)){var i=n,r=i+"-"+l+"-config";a.append(u._configTableRowFactory.create(i,e[i],r))}t.css("animationName","animateIn")}t.toggleClass("open")}}]),e}();t.WidgetConfigurationView=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(1),r=a(21),o=a(25),s=null,l=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s||(s=this,this.dataModelProxy=new i.DataModelProxy,this.sensorThingsCommunications=new r.SensorThingsCommunications,this.search=new o.Search),s}return n(e,[{key:"loadDataStreamList",value:function(){var e=this;this._dataStreamList=[];var t=this.dataModelProxy.getUserConfig().getDashboardConfig().getServerList(),a=0,n=function(n){var i=a;e.sensorThingsCommunications.getDataStreamList(t[n].url,function(e){this.dataStreamListAvailable(e,i)}.bind(e)),a++};for(var i in t)n(i)}},{key:"dataStreamListAvailable",value:function(e,t){e.forEach(function(e){e["server-id"]=t}),this._dataStreamList=this._dataStreamList.concat(e)}},{key:"create",value:function(e,t,a){switch(t.type){case TYPE_COLOR:return s._createColorRow(e,t.data,a);case TYPE_STRING:return s._createStringRow(e,t.data,a);case TYPE_INTEGER:return s._createIntegerRow(e,t.data,a);case TYPE_BOOLEAN:return s._createCheckboxRow(e,t.data,a);case TYPE_ARRAY:return s._createArrayRow(e,t.data,a);case TYPE_DATE:return s._createDateRow(e,t.data,a);case TYPE_DROPDOWN:return s._createDropdownRow(e,t.data,t.options,a);case TYPE_NUMBER:return s._createNumberRow(e,t.data,a);case TYPE_FUZZY_SENSOR_SEARCH:return s._createFSSearchRow(e,t.data,a);case TYPE_OBJECT:return s._createObjectRow(e,t.data,a);default:return s._createSimpleRow(e,t.data,t.type,a)}}},{key:"_createStringRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="string"><input class="widget-config-input" type="text" value="'+t+'" id="'+a+'"></td>'),n}},{key:"_createIntegerRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="int"><input class="widget-config-input" type="number" step="1" value="'+t+'" id="'+a+'"></td>'),n}},{key:"_createDateRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="date"><input class="widget-config-input" type="datetime-local" value="'+this._dateAddMinutes(t,-1*(new Date).getTimezoneOffset()).toISOString().substring(0,t.toISOString().length-2)+'" id="'+a+'"></td>'),n}},{key:"_createDropdownRow",value:function(e,t,a,n){var i=$("<tr class='widget-config-item'></tr>"),r="";for(var o in a)r=t==a[o]?r+'<option value="'+a[o]+'" selected>'+o+"</option>":r+'<option value="'+a[o]+'">'+o+"</option>";return $(i).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="dropdown"><select class="widget-config-input" id="'+n+'">'+r+"</select></td>"),i}},{key:"_createNumberRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="number"><input class="widget-config-input" type="number" value="'+t+'" id="'+a+'"></td>'),n}},{key:"_selectedResult",value:function(e){var t=$(e.target).filter("li");t.length<=0&&(t=$(e.target).parent().filter("li")).length<=0&&(t=$(e.target).parent().parent().filter("li"));var a=$(t).attr("key-id"),n=$(t).attr("server-id"),i=$(t).parent().parent().parent().parent().parent();$(i).find(".searcher").val(""),$(i).find(".list").html(""),$(i).find(".urlBox").val(this._dataStreamList.find(function(e){return e["@iot.id"]==a&&e["server-id"]==n})["@iot.selfLink"])}},{key:"_refreshSearchResults",value:function(e){var t=[],a=$(e.target).parent().parent().parent().parent().parent().parent(),n=$(a).find(".list"),i=$(a).find(".searcher"),r=this.search.search(this._dataStreamList,$(i).val(),!1);for(var o in r){var s=r[o].name,l=r[o].description;r[o].observationType,r[o].phenomenonTime;if(null!=r[o].unitOfMeasurement)r[o].unitOfMeasurement.definition,r[o].unitOfMeasurement.name,r[o].unitOfMeasurement.symbol;var u=r[o]["@iot.id"],d=r[o]["server-id"];r[o]["@iot.selfLink"];t.push('<li class="list-group-item serverSelector" key-id='+u+" server-id="+d+'><h3><p class="label label-default search-label">'+s+"</p></h3><h6>"+l+"</h6></li>")}r.length<=0&&""!=$(i).val()&&t.push('<li class="list-group-item"><h3><p class="label label-default">no Results</p></h3></li>'),""!=$(i).val()?$(n).html('<ul class="list-group">'+t.join("")+"</ul>"):$(n).html(""),$(n).find(".serverSelector").off("click"),$(n).find(".serverSelector").on("click",this._selectedResult.bind(this))}},{key:"_createFSSearchRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="fssearch"><table class="fssearchTable"><tbody class="fssearchTBody"><tr><td class="well"><div class="url-box-wrapper" style="white-space: nowrap"><label class="search-box-label"> URL:</label><input class="urlBox form-control" type="url" name="url" placeholder="plain URL to datastream" value="'+t+'"></div></td></tr><tr class="searchFormTableRow"><td class="well"><div class="url-box-wrapper"><label class="search-box-label">Search:</label><input type="search" class="searcher form-control" value="" placeholder="search datastreams for URL"></div><div class="list search-result-list"></div></td></tr></tbody></table></td>'),$(n).find(".searcher").off("keyup"),$(n).find(".searcher").on("keyup",this._refreshSearchResults.bind(this)),n}},{key:"_createColorRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>");return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="color"><input class="widget-config-input" type="color" value="'+t+'" id="'+a+'"></td>'),n}},{key:"_createCheckboxRow",value:function(e,t,a){var n=$("<tr class='widget-config-item'></tr>"),i=1==t?" checked":"";return $(n).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="checkbox"><input class="widget-config-input" type="checkbox" id="'+a+'"'+i+"></td>"),n}},{key:"_createSimpleRow",value:function(e,t,a,n){var i=$("<tr></tr>");return $(i).html('<td class="widget-conf-label" key-id="'+e+'" title="'+window.iotlg[e+"_Tooltip"]+'">'+e+'</td><td class="widget-config-data" input_fmt="simple"><input class="widget-config-input" type="'+a+'" value="'+t+'" id="'+n+'"></td>'),i}},{key:"_createArrayRow",value:function(e,t,a){var n=$("<tr class='widget-config-array-input'></tr>");$(n).html("<td ><div class='conf-array-title-row'><span class='widget-conf-label' key-id='"+e+"'>"+e+"</span> <button class='add-entry-button'>Add <span class='entry-counter badge'>"+t.length+"</span></button></div></td>");var i=$("<table></table>"),r=$(n).find("td");$(r).attr("colspan",2),$(r).append(i),$(i).html("<tbody class='widget-config-array-table'></tbody>");var o=$(i).find(".widget-config-array-table");for(var l in t){var u=s.create(l,t[l],a+"-"+l);$(o).append(u)}return $(o).children().append(s._getRemoveButton()),$(n).find(".add-entry-button").off("click"),$(n).find(".add-entry-button").on("click",function(e){s._addEntry($(e.target).parent().parent().find("button").parent().parent().parent())}),n}},{key:"_createObjectRow",value:function(e,t,a){var n=$("<tr class='widget-config-object-input'></tr>");$(n).html("<td class='widget-conf-label' key-id='"+e+"'>"+e+"</td>");var i=$("<td></td>"),r=$("<table></table>");$(i).append(r),$(n).append(i),$(r).html("<tbody class='widget-config-object-table'>");$(r).find(".widget-config-object-table");for(var o in t)t.hasOwnProperty(o)&&$(r).append(s.create(o,t[o],a+"-"+o));return n}},{key:"_dateAddMinutes",value:function(e,t){return new Date(e.getTime()+1e3*t*60)}},{key:"_addEntry",value:function(e){var t=$(e).children().children().children().filter("tbody"),a=$(t).children().filter(".widget-config-object-input").length;$(t).append($(t).children().filter(".widget-config-object-input").last().clone()),$(t).children().filter(".widget-config-object-input").last().children().filter(".widget-conf-label").text(a),$(t).children().filter(".widget-config-object-input").last().children().filter(".widget-conf-label").attr("key-id",a),$(t).find(".tr-delete.close").off("click"),$(t).find(".tr-delete.close").on("click",function(e){return s._removeEntry(e),!0}),a++,$(t).parent().parent().children().filter("div").children().filter("button").children().filter(".entry-counter").text(a),$(t).find(".add-entry-button").off("click"),$(t).find(".add-entry-button").on("click",function(e){return s._addEntry($(e.target).parent().parent().find("button").parent().parent().parent()),!0}),$(t).find(".searcher").off("keyup"),$(t).find(".searcher").on("keyup",this._refreshSearchResults.bind(this));var n=$(t).find(".list");$(n).find(".serverSelector").off("click"),$(n).find(".serverSelector").on("click",this._selectedResult.bind(this))}},{key:"_removeEntry",value:function(e){var t=$(e.target).parent().parent().parent(),a=$(t).children().filter(".widget-config-object-input").length;if(a<=1)alert("Cannot delete last Array Object!");else{$(e.target).parent().parent().remove(),$(t).parent().parent().children().filter("div").children().filter("button").children().filter(".entry-counter").text(a-1);for(var n=0;n<a;n++)t.children().filter(".widget-config-object-input").eq(n).children().filter(".widget-conf-label").text(n),t.children().filter(".widget-config-object-input").eq(n).children().filter(".widget-conf-label").attr("key-id",n)}}},{key:"_getRemoveButton",value:function(){var e=$("<td></td>"),t=$("<span class='tr-delete close'>x</span>");return $(t).off("click"),$(t).on("click",function(e){return s._removeEntry(e),!0}),$(e).append(t),e}}]),e}();t.ConfigTableRowFactory=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(22),r=a(24),o=(a(23),null),s=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,this.mqttHandles={},this.nextID=1),o}return n(e,[{key:"createQuery",value:function(e,t,a,n,r){(new i.ServerQuery).createQuery(e,t,a,n,r)}},{key:"createDirectQuery",value:function(e,t){(new i.ServerQuery).createDirectQuery(e,t)}},{key:"createDirectQueryPaging",value:function(e,t){(new i.ServerQuery).createDirectQueryPaging(e,t)}},{key:"getDataStreamList",value:function(e,t){this.createDirectQueryPaging(e+"/Datastreams?$top=100",t)}},{key:"registerMQTT",value:function(e,t,a,n){var i=this._generateTopics(e),o=this.nextID;this.nextID=this.nextID+1,this.mqttHandles[o]=[];var s=function(e){n(e)},l={serverURL:t,genericTopic:a};for(var u in i){var d=new r.MQTTHandle;d.registerMQTT(l.serverURL,l.genericTopic+i[u],s),this.mqttHandles[o].push(d)}return o}},{key:"unregister",value:function(e){if(null!=this.mqttHandles[e]){for(var t in this.mqttHandles[e])this.mqttHandles[e][t].unregister();return this.mqttHandles[e]=null,!0}return!1}},{key:"_generateTopics",value:function(e){var t=[],a=function(e){t.some(function(t){return t==e})||t.push(e)};return(e.DataStream_name||e.DataStream_description||e.DataStream_observationType||e.DataStream_unitOfMeasurement||e.DataStream_observedArea||e.DataStream_phenomenonTime||e.DataStream_resultTime)&&a(""),(e.Observation_phenomenonTime||e.Observation_resultTime||e.Observation_result||e.Observation_resultQuality||e.Observation_validTime||e.Observation_parameters)&&a("/Observations"),(e.FeatureOfInterest_name||e.FeatureOfInterest_description||e.FeatureOfInterest_encodingType||e.FeatureOfInterest_feature)&&a("/Observations/FeatureOfInterest"),(e.ObservedProperty_name||e.ObservedProperty_definition||e.ObservedProperty_description)&&a("/ObservedProperty"),(e.Sensor_name||e.Sensor_description||e.Sensor_encodingType||e.Sensor_metadata)&&a("/Sensor"),(e.Thing_name||e.Thing_description||e.Thing_properties)&&a("/Thing"),e.Thing_HistoricalLocations&&a("/Thing/HistoricalLocations"),(e.Thing_Location_name||e.Thing_Location_description||e.Thing_Location_encodingType||e.Thing_Location_location)&&a("/Thing/Location"),t}}]),e}();t.SensorThingsCommunications=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(23),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"createQuery",value:function(e,t,a,n,r){if(e.length<=0||" "==e)a(null);else{var o=!1;""!=e&&null!=e&&(o=e.indexOf("?")>=0);var s=(new i.STParser).createSelectors(t,o,n,r);this.createDirectQueryPaging(e+s,function(e){(new i.STParser).decodeQuery(e,a)})}}},{key:"createDirectQueryPaging",value:function(e,t){$.ajax({type:"GET",crossDomain:!0,url:e,timeout:12e4,dataType:"json",username:"admin",password:"iosb,KA",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("admin:iosb,KA"))},error:function(e,a,n){window.printAJAXerrors&&console.log("AJAX ERROR:",n,a,e),t(null)},success:function(e){var a=e;(new i.STParser).retrieveAdditionalPages(a,t)}})}},{key:"createDirectQuery",value:function(e,t){$.ajax({type:"GET",crossDomain:!0,url:e,timeout:12e4,dataType:"json",username:"admin",password:"iosb,KA",beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("admin:iosb,KA"))},error:function(e,t,a){window.printAJAXerrors&&console.log("AJAX ERROR:",a,t,e)},success:function(e){t(e)}})}}]),e}();t.ServerQuery=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(21),r=null,o=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r||(r=this,this.stComm=new i.SensorThingsCommunications),r}return n(e,[{key:"_joinObjectOrArray",value:function(e,t){if(e instanceof Array)return t instanceof Array?e.concat(t):e;if(null===e||null===t)return null;for(var a in e)e.hasOwnProperty(a)&&(e[a]=this._joinObjectOrArray(e[a],t[a]));return e}},{key:"_clone",value:function(e){var t=[];for(var a in e)t[a]=e[a];return t}},{key:"_getParam",value:function(e,t){var a=t[0];if(t.length<=0||null==a||""==a)return e;var n=this._clone(t);return n.shift(),this._getParam(e[a],n)}},{key:"_setParam",value:function(e,t,a){var n=t[0];if(1==t.length)return e[n]=a,e;if(t.length<=0||null==n||""==n)return e=a,a;var i=this._clone(t);return i.shift(),e[n]=this._setParam(e[n],i,a),e}},{key:"_deleteParam",value:function(e,t){if(t.length<=1)return null==e?null:(delete e[t[0]],e);var a=t[0],n=this._clone(t);return n.shift(),""==a?null!=t[1]?(e[a]=this._deleteParam(e,n),e):void(e=void 0):(e[a]=this._deleteParam(e[a],n),e)}},{key:"_readAdditionalPages",value:function(e,t){var a=[],n=function(e,t){for(var i in this._getParam(e,t))if(i.search("@iot.nextLink")>=0){var r=this._clone(t),o=this._clone(t),s=i.substring(0,i.search("@iot.nextLink"));""!=s&&null!=s&&r.push(s),o.push(i);var l={path:r,urlPath:o};a.push(l)}else if(this._getParam(e,t)[i]instanceof Object||this._getParam(e,t)[i]instanceof Array){(r=this._clone(t)).push(i),n(e,r)}}.bind(this);n(e,[]);this._checkPaging(e,a,function(e){t(e)}.bind(this))}},{key:"_checkPaging",value:function(e,t,a){var n=this;if(t.length>0){var i=function(){var i=t.length-1;if(null==t[i]||null==t[i].path||null==t[i].urlPath)return a(e),{v:void 0};var r=t[i].path,o=t[i].urlPath;t.pop();var s=n._getParam(e,o);if(null==r||null==s)return a(e),{v:void 0};var l=function(n){null==n&&a(e);var i=this._joinObjectOrArray(this._getParam(e,r),n);e=this._setParam(e,r,i),this._checkPaging(e,t,a)}.bind(n);e=n._setParam(e,o,void 0),n._deleteParam(e,o),n.stComm.createDirectQueryPaging(s,l.bind(n))}();if("object"==typeof i)return i.v}else a(e)}},{key:"retrieveAdditionalPages",value:function(e,t){null!=e.value&&(e.value["@iot.nextLink"]=e["@iot.nextLink"],e=e.value),this._readAdditionalPages(e,t)}},{key:"decodeQuery",value:function(e,t){if(null==e)return t({}),void console.log("ERROR");r._rewriteParams(e,t)}},{key:"_rewriteParams",value:function(e,t){var a={};if(a.DataStream_id=e["@iot.id"],a.DataStream_name=e.name,a.DataStream_description=e.description,a.DataStream_observationType=e.observationType,a.DataStream_unitOfMeasurement=e.unitOfMeasurement,a.DataStream_observedArea=e.observedArea,a.DataStream_phenomenonTime=e.phenomenonTime,a.DataStream_resultTime=e.resultTime,null!=e.Observations&&e.Observations.length>0)for(var n in a.Observations=[],e.Observations)a.Observations[n]={},a.Observations[n].Observation_id=e.Observations[n]["@iot.id"],a.Observations[n].Observation_phenomenonTime=e.Observations[n].phenomenonTime,a.Observations[n].Observation_resultTime=e.Observations[n].resultTime,a.Observations[n].Observation_result=e.Observations[n].result,a.Observations[n].Observation_resultQuality=e.Observations[n].resultQuality,a.Observations[n].Observation_validTime=e.Observations[n].validTime,a.Observations[n].Observation_parameters=e.Observations[n].parameters,null!=e.Observations[n].FeatureOfInterest&&(a.Observations[n].FeatureOfInterest_name=e.Observations[n].FeatureOfInterest.name,a.Observations[n].FeatureOfInterest_description=e.Observations[n].FeatureOfInterest.description,a.Observations[n].FeatureOfInterest_encodingType=e.Observations[n].FeatureOfInterest.encodingType,a.Observations[n].FeatureOfInterest_feature=e.Observations[n].FeatureOfInterest.feature);if(null!=e.ObservedProperty&&(a.ObservedProperty_name=e.ObservedProperty.name,a.ObservedProperty_definition=e.ObservedProperty.definition,a.ObservedProperty_description=e.ObservedProperty.description),null!=e.Sensor&&(a.Sensor_name=e.Sensor.name,a.Sensor_description=e.Sensor.description,a.Sensor_encodingType=e.Sensor.encodingType,a.Sensor_metadata=e.Sensor.metadata),null!=e.Thing&&(a.Thing_name=e.Thing.name,a.Thing_description=e.Thing.description,a.Thing_properties=e.Thing.properties,a.Thing_HistoricalLocations=e.Thing.HistoricalLocations),null!=e.Thing&&null!=e.Thing.Locations&&e.Thing.Locations.length>0)for(var n in a.Thing_Locations=[],e.Thing.Locations)a.Thing_Locations[n]={},null!=e.Thing.Locations[n]&&(a.Thing_Locations[n].id=e.Thing.Locations[n]["@iot.id"],a.Thing_Locations[n].name=e.Thing.Locations[n].name,a.Thing_Locations[n].description=e.Thing.Locations[n].description,a.Thing_Locations[n].encodingType=e.Thing.Locations[n].encodingType,a.Thing_Locations[n].location=e.Thing.Locations[n].location);t(a)}},{key:"createSelectors",value:function(e,t,a,n){var i={dataStream:{},observation:{},featureOfInterest:{},observedProperty:{},sensor:{},thing:{},historicalLocations:{},location:{}};(e.DataStream_name||e.DataStream_description||e.DataStream_observationType||e.DataStream_unitOfMeasurement||e.DataStream_observedArea||e.DataStream_phenomenonTime||e.DataStream_resultTime)&&(i.dataStream.required=!0),(e.Observation_phenomenonTime||e.Observation_resultTime||e.Observation_result||e.Observation_resultQuality||e.Observation_validTime||e.Observation_parameters)&&(i.observation.required=!0),(e.FeatureOfInterest_name||e.FeatureOfInterest_description||e.FeatureOfInterest_encodingType||e.FeatureOfInterest_feature)&&(i.featureOfInterest.required=!0),(e.ObservedProperty_name||e.ObservedProperty_definition||e.ObservedProperty_description)&&(i.observedProperty.required=!0),(e.Sensor_name||e.Sensor_description||e.Sensor_encodingType||e.Sensor_metadata)&&(i.sensor.required=!0),(e.Thing_name||e.Thing_description||e.Thing_properties)&&(i.thing.required=!0),e.Thing_HistoricalLocations&&(i.historicalLocations.required=!0),(e.Thing_Location_name||e.Thing_Location_description||e.Thing_Location_encodingType||e.Thing_Location_location)&&(i.location.required=!0);var r={};i.observation.required&&(r.Observations={}),i.featureOfInterest.required&&(null==r.Observations&&(r.Observations={}),r.Observations.FeatureOfInterest={}),i.observedProperty.required&&(r.ObservedProperty={}),i.sensor.required&&(r.Sensor={}),i.thing.required&&(r.Thing={}),i.historicalLocations.required&&(null==r.Thing&&(r.Thing={}),r.Thing.HistoricalLocations={},r.Thing.HistoricalLocations.Locations={}),i.location.required&&(null==r.Observations&&(r.Observations={}),r.Thing.Locations={});var o=function(e,t,a,n){var i="";if(Object.keys(e).length>0){for(var r in e){var s=o(e[r],";",a,n);if(""==s){var l="";r.search("Observations")>=0?a?(l="$orderby=phenomenonTime desc"+t+"$filter=phenomenonTime gt "+a,n&&(l=l+" and phenomenonTime lt "+n),i=i+r+"($top=1000"+t+l+"),"):i=i+r+"($top=1"+t+"$orderby=phenomenonTime desc),":i=i+r+"($top=1000),"}else{l="";r.search("Observations")>=0&&(a?(l="$orderby=phenomenonTime desc"+t+"$filter=phenomenonTime gt "+a,n&&(l=l+" and phenomenonTime lt "+n),l+=t):i=i+r+"($top=1"+t+"$orderby=phenomenonTime desc"+t+"$expand="+s+"),"),i=i+r+"($top=1000"+t+l+"$expand="+s+"),"}}return i.substring(0,i.length-1)}return i}.bind(this),s="?$top=1000";if(t&&(s="&$top=1000"),Object.keys(r).length>0){s+="&$expand=";var l=!!n&&new Date(n).toISOString();s+=o(r,";",new Date(a).toISOString(),l)}return s}}]),e}();t.STParser=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(23),r=[],o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"_getClient",value:function(e,t){for(var a in r)if(null!=r[a]&&r[a].serverURL==e)return null!=t&&t(r[a]),r[a];var n=mqtt.connect(e),o={client:n,serverURL:e,registeredTopics:[]};return n.on("connect",function(){console.log("conected to ",e),null!=t&&t(o)}),n.on("message",function(t,a){for(var n=new String,r=0;r<a.length;r++)n+=String.fromCharCode(a[r]);var o=JSON.parse(n),s=function(a){this._getTopic(e,t).callback(a,t)}.bind(this),l={Observations:[o]};(new i.STParser).decodeQuery(l,s)}.bind(this)),r.push(o),null}},{key:"_getTopic",value:function(e,t){var a=this._getClient(e,null);return null!=a?(null==a.registeredTopics[t]&&(a.client.subscribe(t),a.registeredTopics[t]={}),a.registeredTopics[t]):null}},{key:"registerMQTT",value:function(e,t,a){var n=this._getTopic(e,t);return this.serverURL=e,this.topic=t,null==n?(this._getClient(e,function(n){this._getTopic(e,t).callback=a}.bind(this)),!1):(n.callback=a,!0)}},{key:"unregister",value:function(){this._getClient(this.serverURL,function(e){if(e.client.unsubscribe(this.topic),Object.keys(e.registeredTopics).length<=0){var t=r.findIndex(function(e){return e.serverURL==this.serverURL});clObj.end(),r.splice(t,1)}}.bind(this))}}]),e}();t.MQTTHandle=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var n=null,i=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n||(n=this,this.a=null),n}return a(e,[{key:"search",value:function(e,t,a){this.onlyUnit=a||!1;var i=[];if(!(e instanceof Array||t instanceof String))return i;if(void 0!=e)for(var r=0;r<e.length;r++)n.fuzzySearch(e[r].description,t)&&!a?i.push(e[r]):n.fuzzySearch(e[r].name,t)&&!a?i.push(e[r]):n.fuzzySearch(e[r].unitOfMeasurement.name,t)?i.push(e[r]):n.fuzzySearch(e[r].unitOfMeasurement.symbol,t)&&i.push(e[r]);return i}},{key:"fuzzySearch",value:function(e,t){if(!t||!e)return!1;var a=e.toLowerCase(),n=0,i=-1,r=void 0;for(t=t.toLowerCase();r=t[n++];)if(!~(i=a.indexOf(r,i+1)))return!1;return!0}}]),e}();t.Search=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(27),r=a(1),o=null,s=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,this.parser=new i.Parser,this.dataModelProxy=new r.DataModelProxy,this._tree=null,this._jsonData=null),o}return n(e,[{key:"configJSONImport",value:function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("multiple","false"),e.setAttribute("accept",".json"),e.addEventListener("change",function(){o._insertFile(e)},!1),e.click()}},{key:"configJSONExport",value:function(){var e=this.dataModelProxy.getUserConfig();this._jsonData=this.parser.configStore(e);var t="data:text/json;charset=utf-8,"+encodeURIComponent(this._jsonData),a=document.getElementById("downloadAnchorElem");return a.setAttribute("href",t),a.setAttribute("download",this._getCurrentDate()+"_userConfig.json"),a.click(),window.hideConfig(),!0}},{key:"_insertFile",value:function(e){e.value?function(){var t=e.files[0],a=new FileReader;a.onload=function(){var e=a.result;this._tree=o.parser.configLoad(e),o.dataModelProxy.importNewUserConfig(this._tree),window.hideConfig()},a.readAsText(t)}():console.error("Path missing.")}},{key:"configFileImport",value:function(e){return this._tree=this.parser.configLoad(e),o.dataModelProxy.importNewUserConfig(this._tree),this._tree}},{key:"configFileExport",value:function(){var e=this.dataModelProxy.getUserConfig();return this._jsonData=this.parser.configStore(e),this._jsonData}},{key:"_getCurrentDate",value:function(){var e=new Date,t=e.getMinutes(),a=e.getHours(),n=e.getDate(),i=e.getMonth()+1,r=e.getFullYear();return n<10&&(n="0"+n),i<10&&(i="0"+i),t<10&&(t="0"+t),a<10&&(a="0"+a),r+i+n+"_"+a+t}}]),e}();t.ImportExport=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var n=null,i=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n||(n=this,this.tree={dashboardConfig:{serverList:[],title:""},widgetConfig:{widgetDataArray:[]}}),this}return a(e,[{key:"configLoad",value:function(e){var t=JSON.parse(e);for(var a in t.widgetConfig.widgetDataArray)for(var n in t.widgetConfig.widgetDataArray[a].configurableData){var i=null;switch(t.widgetConfig.widgetDataArray[a].configurableData[n].type){case TYPE_INTEGER:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=parseInt(i);break;case TYPE_BOOLEAN:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=this.makeBoolean(i);break;case TYPE_ARRAY:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=i;break;case TYPE_DATE:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=new Date(i);break;case TYPE_DROPDOWN:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=parseInt(i);break;case TYPE_NUMBER:i=t.widgetConfig.widgetDataArray[a].configurableData[n].data,t.widgetConfig.widgetDataArray[a].configurableData[n].data=parseFloat(i)}}return t}},{key:"makeBoolean",value:function(e){return"true"==e||"false"!=e&&e}},{key:"configStore",value:function(e){this.tree={dashboardConfig:{serverList:[],title:""},widgetConfig:{widgetDataArray:[]}},this.tree.dashboardConfig.title=e.getDashboardConfig().getTitle(),this.tree.dashboardConfig.serverList=e.getDashboardConfig().getServerList();for(var t=e.getWidgetConfig().getConfigContent(),a=0;a<t.length;a++)this._parseQueryWidget(t[a]);return JSON.stringify(this.tree)}},{key:"parseDates",value:function(e){for(var t in e.widgetConfig.widgetDataArray){var a=e.widgetConfig.widgetDataArray[t].configurableData;for(var n in a)"number"==typeof a[n].type&&5==a[n].type&&(a[n].data=new Date(a[n].data))}return e}},{key:"_parseQueryWidget",value:function(e){var t={configurableData:e.configurableData,position:e.position,size:e.size,type:e.type};this.tree.widgetConfig.widgetDataArray.push(t)}}]),e}();t.Parser=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(8),o=null,s=null,l=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=this,new i.View,s=new r.UserEvents,this.modified=!1),o}return n(e,[{key:"_getServerTableRowDummy",value:function(e){var t=document.createElement("TR");return t.innerHTML="<td>"+e.name+"</td><td>"+e.url+"</td><td><span class='tr-delete close' style='font-size: large'/>x</td>",t.querySelector(".tr-delete").onclick=function(e){return o._removeServer(e)},t}},{key:"_getServerTableAddRow",value:function(){var e=document.createElement("TR");return e.innerHTML="<td><input id='conf-server-name'></td><td><input id='conf-server-url'></td><td><button class='btn btn-success conf-btn-add-server'>"+window.iotlg.addButton+"</button></td>",e}},{key:"_toggleConfigure",value:function(){var e=this,t=$("div.conf-popup#configure");t.hasClass("open")?(o._setModified(!1),t.css("animationName","animateOut"),window.hideConfig=function(){}):function(){var a=s.loadUserConfig();t.find("#conf_title").text(window.iotlg.dbConfig+" "+a.dashboardConfig.getTitle()),t.find("#conf-label-title").text(window.iotlg.dbTitle),t.find("#conf-input-title").val(a.dashboardConfig.getTitle()),t.find("#conf-label-servers").text(window.iotlg.serverList);var n=t.find(".conf-server-table");n.html(""),a.dashboardConfig.getServerList().forEach(function(e){n.append(o._getServerTableRowDummy(e))}),n.append(o._getServerTableAddRow()),$(".conf-btn-add-server").click(function(){return o._addServer()}),$(".tr-delete.close").click(function(e){return o._removeServer(e)}),t.css("animationName","animateIn"),window.hideConfig=e._toggleConfigure.bind(e)}(),t.toggleClass("open")}},{key:"_addServer",value:function(){var e=$(".conf-server-table")[0],t=$("#conf-server-name"),a=$("#conf-server-url");if(""!=t.val()&&""!=a.val()){var n={name:t.val(),url:a.val()};t.val(""),a.val(""),e.insertBefore(o._getServerTableRowDummy(n,e.childElementCount),e.lastChild),o._setModified(!0)}}},{key:"_removeServer",value:function(e){e.target.parentElement.parentElement.remove(),o._setModified(!0)}},{key:"_saveConfig",value:function(){var e=s.loadUserConfig(),t=$("#conf-input-title").val();e.dashboardConfig.setTitle(t);var a=[],n=$(".conf-server-table tr");n.each(function(e){a.push({name:n[e].childNodes[0].innerHTML,url:n[e].childNodes[1].innerHTML})}),a.pop(),a.sort(function(e,t){return e.name!=t.name?e.name.localeCompare(t.name):e.url.localeCompare(t.url)}),e.dashboardConfig.setServerList(a),o._setModified(!1)}},{key:"_setModified",value:function(e){o.modified=e}},{key:"_importConfig",value:function(){s.importConfig()}},{key:"_exportConfig",value:function(){o.modified?alert(window.iotlg.warningConfigModified):s.exportConfig()}},{key:"_importFromCMS",value:function(){s.importFromCMS()}},{key:"_exportToCMS",value:function(){o.modified?alert(window.iotlg.warningConfigModified):s.exportToCMS()}}]),e}();t.UserConfigurationView=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(30),r=a(2),o=a(21),s=null,l=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s||(s=this,this.myDataObserver=new i.DataObserver,this.myDataModel=new r.DataModel,this.myDataModel.getUserConfig().getWidgetConfig().registerDataStreamsObserver(this.update.bind(this))),s}return n(e,[{key:"_getMilliseconds",value:function(e,t){switch(t){case UNIT_MILLISECOND:return e;case UNIT_SECOND:return 1e3*e;case UNIT_MINUTE:return 1e3*e*60;case UNIT_HOUR:return 1e3*e*60*60;case UNIT_DAY:return 1e3*e*60*60*24;case UNIT_MONTH:return 1e3*e*60*60*24*31;case UNIT_YEAR:return 1e3*e*60*60*24*365;default:return console.error("Error, unknown unit constant"),e}}},{key:"update",value:function(e,t,a){if(t){var n=a.getQueryIDs();for(var i in n)this.myDataObserver.deleteQuery(n[i])}if(e){var r=a.getParameterMap(),o=[],s=a.getDataCallback(),l=a.getQueryParams();for(var i in l){var u=l[i].data.dataStreamUrl.data,d=l[i].data.mqttEnabled.data,c=l[i].data.mqttUrl.data,f=l[i].data.mqttBaseTopic.data,g=l[i].data.updateIntervalMs.data,h=a.getConfigurableData();if(d)o.push(this.myDataObserver.newMQTTQuery(r,c,f,s[i]));else if(null!=h.startTime&&null!=h.endTime&&null!=h.timeInterval&&null!=h.timeIntervalUnit&&null!=h.timeIntervalRelative){var v=h.startTime.data,p=h.endTime.data,_=this._getMilliseconds(h.timeInterval.data,h.timeIntervalUnit.data);0;var y=h.timeIntervalRelative.data;o.push(this.myDataObserver.newQuery(r,g,u,s[i],v,p,_,y))}else o.push(this.myDataObserver.newQuery(r,g,u,s[i],0,0,-1,!0))}a.setQueryIDs(o)}}},{key:"getDataStreamList",value:function(e,t){(new o.SensorThingsCommunications).getDataStreamList(e,t)}}]),e}();t.DataQueryObserverProxy=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(31),r=a(34),o=a(33),s=a(32),l=a(21),u=null,d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u||(u=this,this.sync=this.mySyncFunction.bind(this),this.mySensorThingsCommunication=new l.SensorThingsCommunications,this.queryIDcounter=0,this.syncFreq=t,this.myDataQuerySynchronizing=new i.DataQuerySynchronizing,this.myTimer=window.setInterval(this.sync,this.syncFreq),this.running=!1),u}return n(e,[{key:"newQuery",value:function(e,t,a,n,i,r,s,l){this.queryIDcounter+=1;var u=this.queryIDcounter,d=new o.TimedQuery(e,t,a,n,i,r,s,l);return d.setQueryID(u),this.myDataQuerySynchronizing.addQuery(d),u}},{key:"newMQTTQuery",value:function(e,t,a,n){this.queryIDcounter+=1;var i=this.queryIDcounter;return this.myDataQuerySynchronizing.addQuery(new s.MQTTQuery(e,t,a,n)),i}},{key:"newRandomQuery",value:function(e,t){this.queryIDcounter+=1;var a=this.queryIDcounter;return this.myDataQuerySynchronizing.addQuery(new r.RandomDataQuery(e,t)),a}},{key:"deleteQuery",value:function(e){this.myDataQuerySynchronizing.removeQuery(e)}},{key:"setSyncFreq",value:function(e){clearInterval(this.myTimer),this.syncFreq=e,this.myTimer=window.setInterval(this.sync,this.syncFreq)}},{key:"getSyncFreq",value:function(){return this.syncFreq}},{key:"mySyncFunction",value:function(){if(!this.running||this.lastRan+100*this.getSyncFreq()<(new Date).getTime()){this.lastRan=(new Date).getTime(),this.running=!0,this.myDataQuerySynchronizing.clearRegisteredQueries(),this.myDataQuerySynchronizing.registerTimedQueries();this.myDataQuerySynchronizing.loadRegistered(function(){this.running=!1}.bind(this))}}}]),e}();t.DataObserver=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(32);var i=a(33),r=(a(34),a(21)),o=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queryList=[],this.registeredQueries=[],this}return n(e,[{key:"addQuery",value:function(e){this.queryList.push(e)}},{key:"removeQuery",value:function(e){for(var t in this.registeredQueries)this.registeredQueries[t].getQueryID()==e&&this.registeredQueries.splice(t,1);for(var t in this.queryList)if(this.queryList[t].getQueryID()==e){var a=this.queryList[t];this.queryList.splice(t,1),a.destroy()}}},{key:"registerTimedQueries",value:function(){for(var e in this.queryList)this.queryList[e].registerIfNeeded(Date.now())&&this.registeredQueries.push(this.queryList[e])}},{key:"_completeParameterList",value:function(e){return e.DataStream_name=e.DataStream_name||!1,e.DataStream_description=e.DataStream_description||!1,e.DataStream_observationType=e.DataStream_observationType||!1,e.DataStream_unitOfMeasurement=e.DataStream_unitOfMeasurement||!1,e.DataStream_observedArea=e.DataStream_observedArea||!1,e.DataStream_phenomenonTime=e.DataStream_phenomenonTime||!1,e.DataStream_resultTime=e.DataStream_resultTime||!1,e.Observation_phenomenonTime=e.Observation_phenomenonTime||!1,e.Observation_resultTime=e.Observation_resultTime||!1,e.Observation_result=e.Observation_result||!1,e.Observation_resultQuality=e.Observation_resultQuality||!1,e.Observation_validTime=e.Observation_validTime||!1,e.Observation_parameters=e.Observation_parameters||!1,e.FeatureOfInterest_name=e.FeatureOfInterest_name||!1,e.FeatureOfInterest_description=e.FeatureOfInterest_description||!1,e.FeatureOfInterest_encodingType=e.FeatureOfInterest_encodingType||!1,e.FeatureOfInterest_feature=e.FeatureOfInterest_feature||!1,e.ObservedProperty_name=e.ObservedProperty_name||!1,e.ObservedProperty_definition=e.ObservedProperty_definition||!1,e.ObservedProperty_description=e.ObservedProperty_description||!1,e.Sensor_name=e.Sensor_name||!1,e.Sensor_description=e.Sensor_description||!1,e.Sensor_encodingType=e.Sensor_encodingType||!1,e.Sensor_metadata=e.Sensor_metadata||!1,e.Sensor_properties=e.Sensor_properties||!1,e.Thing_name=e.Thing_name||!1,e.Thing_HistoricalLocations=e.Thing_HistoricalLocations||!1,e.Thing_Location_name=e.Thing_Location_name||!1,e.Thing_Location_description=e.Thing_Location_description||!1,e.Thing_Location_encodingType=e.Thing_Location_encodingType||!1,e.Thing_Location_location=e.Thing_Location_location||!1,e}},{key:"loadRegistered",value:function(e){var t=this,a=[];for(var n in this.registeredQueries)this.registeredQueries[n]instanceof i.TimedQuery&&function(){var e=t.registeredQueries[n].getQueryString(),i=t.registeredQueries[n].getParameterMap(),r=t.registeredQueries[n].getObsStart(),o=t.registeredQueries[n].getObsEnd(),s=function(e){return e.obsStart==r&&e.obsEnd==o};if(a[e])if(a[e].some(s)){var l=a[e].find(s);for(var u in l.qID.push(t.registeredQueries[n].getQueryID()),i)null==l.parameterList&&(l.parameterList={}),l.parameterList[u]=l.parameterList[u]||i[u]}else a[e].push({parameterList:i,obsStart:r,obsEnd:o,qID:[t.registeredQueries[n].getQueryID()]});else a[e]=[],a[e].push({parameterList:i,obsStart:r,obsEnd:o,qID:[t.registeredQueries[n].getQueryID()]})}();var o=function(){var t=this,n=function(e){if(t.registeredQueries[e]instanceof i.TimedQuery){t.registeredQueries[e].getObsStart,t.registeredQueries[e].getObsEnd;var n=a[t.registeredQueries[e].getQueryString()].find(function(t){return t.qID.some(function(t){if(null!=this.registeredQueries[e])return t==this.registeredQueries[e].getQueryID()}.bind(this))}.bind(t));null!=n?t.registeredQueries[e].callIt(n.result):t.registeredQueries[e].callIt(null)}else t.registeredQueries[e].callIt(null)};for(var r in this.registeredQueries)n(r);e()}.bind(this),s=0,l=function(e){var n=function(n){var i=e,l=t._completeParameterList(a[e][n].parameterList),u=a[e][n].obsStart,d=a[e][n].obsEnd,c=function(t){a[e][n].result=t,(s-=1)<=0&&o()};s+=1,u instanceof Date&&d instanceof Date&&!(u.getTime()<=d.getTime())?c(null):(new r.SensorThingsCommunications).createQuery(i,l,c.bind(t),u,d)};for(var i in a[e])n(i)};for(var n in a)l(n);s<=0&&o()}},{key:"clearRegisteredQueries",value:function(){this.registeredQueries=[]}}]),e}();t.DataQuerySynchronizing=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(21),r=!1,o=function(){function e(t,a,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r&&console.log("new MQTTQuery Object"),this.setCallback(o),this.setParameterMap(t),this.setHandleID((new i.SensorThingsCommunications).registerMQTT(t,a,n,o))}return n(e,[{key:"setParameterMap",value:function(e){this.parameterMap=e}},{key:"getParameterMap",value:function(){return this.parameterMap}},{key:"setHandleID",value:function(e){this.handleID=e}},{key:"getHandleID",value:function(){return this.handleID}},{key:"registerIfNeeded",value:function(e){return!1}},{key:"getQueryID",value:function(){return this.queryId}},{key:"setQueryID",value:function(e){this.queryId=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getCallback",value:function(){return this.callback}},{key:"callIt",value:function(e){this.callback&&this.callback(e)}},{key:"destroy",value:function(){(new i.SensorThingsCommunications).unregister(this.getHandleID)}}]),e}();t.MQTTQuery=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(21);var i=!1,r=function(){function e(t,a,n,r,o,s,l,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.interval=a,this.query=n,this.callback=r,this.lastCalled=0,this.lastDataCalled=0,this.obsStart=o,this.obsEnd=s,this.obsSize=l,this.obsRel=u,this.onlyLatest=this.obsSize<0,this.setParameterMap(t),i&&console.log("creating a new timed Query to",n)}return n(e,[{key:"setParameterMap",value:function(e){this.parameterMap=e}},{key:"getParameterMap",value:function(){return this.parameterMap}},{key:"registerIfNeeded",value:function(e){return e>this.interval+this.lastCalled&&(this.lastCalled=Date.now(),!0)}},{key:"getQueryID",value:function(){return this.queryId}},{key:"setQueryID",value:function(e){this.queryId=e}},{key:"getQueryString",value:function(){return this.query}},{key:"setQueryString",value:function(e){i&&console.log(this.getQueryID(),"setting QueryString to",e),this.query=e}},{key:"_subtractDate",value:function(e,t){return new Date(e.getTime()-t)}},{key:"_deleteOld",value:function(e,t){return e.filter(function(e){return new Date(e.Observation_phenomenonTime).getTime()>(new Date).getTime()-t})}},{key:"getObsStart",value:function(){return!this.onlyLatest&&(0!=this.lastDataCalled?new Date(this.lastDataCalled):this.obsRel?this._subtractDate(new Date,this.obsSize):this.obsStart)}},{key:"getObsEnd",value:function(){return!this.obsRel&&this.obsEnd}},{key:"_getLatestTime",value:function(e){var t=0;for(var a in e){var n=new Date(e[a].Observation_phenomenonTime).getTime();n>t&&(t=n)}return i&&console.log("found latest:",t,e),t}},{key:"callIt",value:function(e){if(this.callback&&null!=e){if(i&&null!=e.Observations&&e.Observations.length>0&&console.log("new Data pushed",this.getQueryID()),null==this.curData)this.curData=e,this.lastDataCalled=this._getLatestTime(this.curData.Observations);else if(null!=e.Observations&&null!=this.curData.Observations){e.Observations=[].concat(e.Observations,this.curData.Observations),this.obsRel&&(e.Observations=this._deleteOld(e.Observations,this.obsSize)),this.curData=e,this.lastDataCalled=this._getLatestTime(this.curData.Observations)}else null==e.Observations&&(this.obsRel&&null!=this.curData.Observations&&(this.curData.Observations=this._deleteOld(this.curData.Observations,this.obsSize)),e.Observations=this.curData.Observations,this.curData=e);this.callback(this.curData)}}},{key:"destroy",value:function(){}}]),e}();t.TimedQuery=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var n=function(){function e(t,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.interval=1e3,this.lastCalled=0,this.callback=a,this.setParameterMap(t),this.myObservations=[],this.currentID=1,this.callIt=this.callMe.bind(this)}return a(e,[{key:"setParameterMap",value:function(e){this.parameterMap=e}},{key:"getParameterMap",value:function(){return this.parameterMap}},{key:"getQueryID",value:function(){return this.queryId}},{key:"setQueryID",value:function(e){this.queryId=e}},{key:"registerIfNeeded",value:function(e){return e>this.interval+this.lastCalled}},{key:"callMe",value:function(e){this.lastCalled=Date.now();var t=this.getParameterMap();if(this.callback){this.currentID=this.currentID+1;var a={},n=(new Date).toISOString(),i=Math.floor(50*Math.sin(this.currentID))+50;a.DataStream_id=0,a.DataStream_name=t.DataStream_name?"Random Data Stream":void 0,a.DataStream_description=t.DataStream_description?"Random Data Stream":void 0,a.DataStream_observationType=t.DataStream_observationType?"Random":void 0,a.DataStream_unitOfMeasurement=t.DataStream_unitOfMeasurement?"ran":void 0,a.DataStream_observedArea=t.DataStream_observedArea?{}:void 0,a.DataStream_phenomenonTime=t.DataStream_phenomenonTime?n:void 0,a.DataStream_resultTime=t.DataStream_resultTime?n:void 0;var r={};r.Observation_id=this.currentID,r.Observation_phenomenonTime=t.Observation_phenomenonTime?n:void 0,r.Observation_resultTime=t.Observation_resultTime?n:void 0,r.Observation_result=t.Observation_result?i:void 0,r.Observation_resultQuality=t.Observation_resultQuality?{}:void 0,r.Observation_validTime=t.Observation_validTime?n+"P24H":void 0,r.Observation_parameters=t.Observation_parameters?{randomData:!0}:void 0,r.FeatureOfInterest_name=t.FeatureOfInterest_name?"Random Feature":void 0,r.FeatureOfInterest_description=t.FeatureOfInterest_description?"Random Feature":void 0,r.FeatureOfInterest_encodingType=t.FeatureOfInterest_encodingType?"application/vnd.geo+json":void 0,r.FeatureOfInterest_feature=t.FeatureOfInterest_feature?{type:"Point",coordinates:[-117.05,51.05]}:void 0,this.myObservations.push(r),a.Observations=this.myObservations,a.ObservedProperty_name=t.ObservedProperty_name?"Random":void 0,a.ObservedProperty_definition=t.ObservedProperty_definition?"Random":void 0,a.ObservedProperty_description=t.ObservedProperty_description?"Random":void 0,a.Sensor_name=t.Sensor_name?"Random Sensor":void 0,a.Sensor_description=t.Sensor_description?"Random Sensor":void 0,a.Sensor_encodingType=t.Sensor_encodingType?"application/pdf":void 0,a.Sensor_metadata=t.Sensor_metadata?"Random Sensor":void 0,a.Thing_name=t.Thing_name?"Random":void 0,a.Thing_description=t.Sensor_description?"Random":void 0,a.Thing_properties=t.Sensor_properties?{reference:"first"}:void 0,a.Thing_HistoricalLocations=t.Thing_HistoricalLocations?[{time:n},{time:n}]:void 0,a.Thing_Locations=[];var o={id:1};o.name=t.Thing_Location_name?"Random Sensor Location":void 0,o.description=t.Thing_Location_description?"Random Sensor Location":void 0,o.encodingType=t.Thing_Location_encodingType?"application/vnd.geo+json":void 0,o.location=t.Thing_Location_location?{type:"Point",coordinates:[8.404,49.014]}:void 0,a.Thing_Locations.push(o),this.callback(a)}}},{key:"destroy",value:function(){}}]),e}();t.RandomDataQuery=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_PLAINTEXT,this.configCallbacks=[],this.allData=[],this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"_initConfigurableData",value:function(){this.configurableData={text:{data:window.iotlg.textWidgetDefaultText,type:TYPE_STRING},title:{data:"Plaintext Widget",type:TYPE_STRING},fontSize:{data:27,type:TYPE_INTEGER}}}},{key:"registerViewCallback",value:function(e,t){this.configCallbacks.push(t),t(this.configurableData)}},{key:"destroy",value:function(){this.view.removeWidget(this.id)}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryID",value:function(e){this.queryID=e}}]),e}();t.PlainTextWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(8),r=null,o=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r||(r=this,this.title="Dashboard: "+window.iotlg.headerDefTitle,this.serverList=[{name:"Standard",url:"https://81.169.204.149:8080/FROST-Server/v1.0"}],this._relative=!1,this._absoluteLimit=1e3,this._relativeUnit=4,this._relativeValue=1,this._userEvents=new i.UserEvents),r}return n(e,[{key:"getTitle",value:function(){return this.title}},{key:"getServerList",value:function(){return this.serverList}},{key:"setTitle",value:function(e){this.title=e,this._userEvents.dashboardConfigChanged()}},{key:"setServerList",value:function(e){this.serverList=e,this._userEvents.dashboardConfigChanged()}}]),e}();t.DashboardConfig=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_GAUGE,this.dataCallbacks=[],this.configCallbacks=[],this.allData=[],this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!1,DataStream_observedArea:!1,DataStream_phenomenonTime:!0,DataStream_resultTime:!1,Observation_phenomenonTime:!1,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"_initConfigurableData",value:function(){this.configurableData={title:{data:"Gauge Widget",type:TYPE_STRING},min:{data:0,type:TYPE_NUMBER},max:{data:100,type:TYPE_NUMBER},shadow:{data:!0,type:TYPE_BOOLEAN},textColor:{data:"#000000",type:TYPE_COLOR},tickmarksBigColor:{data:"#000055",type:TYPE_COLOR},tickmarksMediumColor:{data:"#000033",type:TYPE_COLOR},tickmarksSmallColor:{data:"#000000",type:TYPE_COLOR},backgroundColor:{data:"#FFFFFF",type:TYPE_COLOR},borderInnerColor:{data:"#FFFFFF",type:TYPE_COLOR},borderOuterColor:{data:"#EEEEEE",type:TYPE_COLOR},borderOutlineColor:{data:"#BBBBBB",type:TYPE_COLOR},needleColor:{data:"#FF0000",type:TYPE_COLOR},needleType:{data:"line",type:TYPE_STRING},needleTail:{data:!0,type:TYPE_BOOLEAN},centerpinRadius:{data:7,type:TYPE_NUMBER},titleTop:{data:"",type:TYPE_STRING},titleTopSize:{data:15,type:TYPE_INTEGER},titleTopColor:{data:"#000000",type:TYPE_COLOR},titleBottom:{data:"",type:TYPE_STRING},titleBottomColor:{data:"#000000",type:TYPE_COLOR},titleBottomSize:{data:12,type:TYPE_INTEGER},labelsCentered:{data:!0,type:TYPE_BOOLEAN},labelsOffset:{data:7,type:TYPE_INTEGER},textAccessible:{data:!0,type:TYPE_BOOLEAN},colorsRanges:{data:[{data:{lower:{data:60,type:TYPE_NUMBER},upper:{data:80,type:TYPE_NUMBER},color:{data:"#FFFF00",type:TYPE_COLOR}},type:TYPE_OBJECT},{data:{lower:{data:80,type:TYPE_NUMBER},upper:{data:100,type:TYPE_NUMBER},color:{data:"#FF0000",type:TYPE_COLOR}},type:TYPE_OBJECT}],type:TYPE_ARRAY},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MONTH,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:new Date,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"newData",value:function(e){for(var t in this.allData=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return[this.newData.bind(this)]}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}}]),e}();t.GaugeWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_BARGRAPH,this.dataCallbacks=[],this.configCallbacks=[],this.dataObserverCallbacks=[this.newData.bind(this)],this.allData=[],this.allData.push([]),this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!0,DataStream_observedArea:!1,DataStream_phenomenonTime:!1,DataStream_resultTime:!1,Observation_phenomenonTime:!0,Observation_resultTime:!0,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"_initConfigurableData",value:function(){var e=new Date;e.setMinutes((new Date).getMinutes()+1),this.configurableData={title:{data:"BarGraph Widget",type:TYPE_STRING},colors:{data:[{data:{barColor:{data:"#000000",type:TYPE_COLOR}},type:TYPE_OBJECT}],type:TYPE_ARRAY},backgroundBarcolor1:{data:"#ffffff",type:TYPE_COLOR},backgroundBarcolor2:{data:"#ffffff",type:TYPE_COLOR},backgroundGrid:{data:!0,type:TYPE_BOOLEAN},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MINUTE,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},timeGroups:{data:3,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:e,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY},titleY:{data:"New 9GAG memes",type:TYPE_STRING}}}},{key:"newData",value:function(e){for(var t in this.allData[0]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return this.dataObserverCallbacks}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this._buildDataCallbacks(e.sensorThingsConfiguration.data),this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}},{key:"_buildDataCallbacks",value:function(e){var t=this;logging&&console.log("building my Datacallbacks"),this.allData=[],this.dataObserverCallbacks=[];var a=0,n=function(e){t.allData.push([]);var n=a;t.dataObserverCallbacks.push(function(e){for(var t in logging&&null!=e&&null!=e.Observations&&e.Observations.length>0&&console.log("pushing data:",e,n),this.allData[n]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}.bind(t)),a++};for(var i in e)n();logging&&console.log("Build "+a+" DataCallbacks")}}]),e}();t.BarGraphData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_LINEGRAPH,this.dataCallbacks=[],this.configCallbacks=[],this.dataObserverCallbacks=[this.newData.bind(this)],this.allData=[],this.allData.push([]),this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"_initConfigurableData",value:function(){var e=new Date;e.setMinutes((new Date).getMinutes()+1),this.configurableData={title:{data:"LineGraph Widget",type:TYPE_STRING},backgroundGridBorder:{data:!1,type:TYPE_BOOLEAN},backgroundGridVlines:{data:!1,type:TYPE_BOOLEAN},backgroundBarcolor1:{data:"#FFFFFF",type:TYPE_COLOR},backgroundBarcolor2:{data:"#FFFFFF",type:TYPE_COLOR},backgroundGridColor:{data:"#000000",type:TYPE_COLOR},tickmarks:{data:"circle",type:TYPE_STRING},ticksize:{data:5,type:TYPE_INTEGER},line:{data:!0,type:TYPE_BOOLEAN},lineColors:{data:[{data:{lineColor:{data:"#000000",type:TYPE_COLOR}},type:TYPE_OBJECT}],type:TYPE_ARRAY},titleXaxis:{data:"Time",type:TYPE_STRING},titleYaxis:{data:"Y-Axis",type:TYPE_STRING},ymin:{data:0,type:TYPE_NUMBER},pointColor:{data:"#000000",type:TYPE_COLOR},labelSteps:{data:4,type:TYPE_INTEGER},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MINUTE,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:e,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!0,DataStream_observedArea:!1,DataStream_phenomenonTime:!1,DataStream_resultTime:!1,Observation_phenomenonTime:!0,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"newData",value:function(e){for(var t in this.allData[0]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),t(this.configurableData),e(this.allData)}},{key:"getDataCallback",value:function(){return this.dataObserverCallbacks}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this._buildDataCallbacks(e.sensorThingsConfiguration.data),this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}},{key:"_buildDataCallbacks",value:function(e){var t=this;this.allData=[],this.dataObserverCallbacks=[];var a=0,n=function(e){t.allData.push([]);var n=a;t.dataObserverCallbacks.push(function(e){for(var t in this.allData[n]=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}.bind(t)),a++};for(var i in e)n()}}]),e}();t.LineGraphWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_PLAINDATA,this.dataCallbacks=[],this.configCallbacks=[],this.allData=[],this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!1,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!0,DataStream_observedArea:!1,DataStream_phenomenonTime:!1,DataStream_resultTime:!1,Observation_phenomenonTime:!0,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"_initConfigurableData",value:function(){this.configurableData={title:{data:"Plain Data Widget",type:TYPE_STRING},valueSize:{data:160,type:TYPE_INTEGER},unitSize:{data:135,type:TYPE_INTEGER},unit:{data:"°C",type:TYPE_STRING},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MONTH,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:new Date,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"newData",value:function(e){for(var t in this.allData=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return[this.newData.bind(this)]}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}}]),e}();t.PlainDataWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_THERMOMETER,this.dataCallbacks=[],this.configCallbacks=[],this.allData=[],this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!0,DataStream_observedArea:!1,DataStream_phenomenonTime:!1,DataStream_resultTime:!1,Observation_phenomenonTime:!0,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"_initConfigurableData",value:function(){this.configurableData={title:{data:"Thermometer Widget",type:TYPE_STRING},titleSide:{data:"",type:TYPE_STRING},min:{data:0,type:TYPE_NUMBER},max:{data:100,type:TYPE_NUMBER},scaleVisible:{data:!0,type:TYPE_BOOLEAN},scaleDecimals:{data:2,type:TYPE_INTEGER},gutterLeft:{data:60,type:TYPE_INTEGER},gutterRight:{data:60,type:TYPE_INTEGER},valueLabel:{data:!1,type:TYPE_BOOLEAN},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MONTH,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:new Date,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"newData",value:function(e){for(var t in this.allData=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return[this.newData.bind(this)]}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getUpdateIntervalMs",value:function(){return this.configurableData.updateIntervalMs.data}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}}]),e}();t.ThermometerWidgetData=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var i=a(6),r=a(4),o=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.type=WIDGET_TYPE_TRAFFICLIGHT,this.dataCallbacks=[],this.configCallbacks=[],this.allData=[],this._initConfigurableData(),this.setAttributes(a),this.view=new i.View,this.widgetConfig=new r.WidgetConfig}return n(e,[{key:"setAttributes",value:function(e){this.position=e.position,this.size=e.size}},{key:"getParameterMap",value:function(){return{DataStream_name:!0,DataStream_description:!1,DataStream_observationType:!1,DataStream_unitOfMeasurement:!1,DataStream_observedArea:!1,DataStream_phenomenonTime:!1,DataStream_resultTime:!1,Observation_phenomenonTime:!0,Observation_resultTime:!1,Observation_result:!0,Observation_resultQuality:!1,Observation_validTime:!1,Observation_parameters:!1,FeatureOfInterest_name:!1,FeatureOfInterest_description:!1,FeatureOfInterest_encodingType:!1,FeatureOfInterest_feature:!1,ObservedProperty_name:!1,ObservedProperty_definition:!1,ObservedProperty_description:!1,Sensor_name:!1,Sensor_description:!1,Sensor_encodingType:!1,Sensor_metadata:!1,Thing_name:!1,Thing_description:!1,Thing_properties:!1,Thing_HistoricalLocations:!1,Thing_Location_name:!1,Thing_Location_description:!1,Thing_Location_encodingType:!1,Thing_Location_location:!1}}},{key:"_initConfigurableData",value:function(){this.configurableData={title:{data:"Traffic Light Widget",type:TYPE_STRING},lower:{data:33,type:TYPE_NUMBER},upper:{data:67,type:TYPE_NUMBER},lowerColor:{data:COLOR_GREEN,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}},middleColor:{data:COLOR_YELLOW,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}},upperColor:{data:COLOR_RED,type:TYPE_DROPDOWN,options:{red:COLOR_RED,yellow:COLOR_YELLOW,green:COLOR_GREEN}},timeIntervalRelative:{data:!0,type:TYPE_BOOLEAN},timeIntervalUnit:{data:UNIT_MONTH,type:TYPE_DROPDOWN,options:{second:UNIT_SECOND,minute:UNIT_MINUTE,hour:UNIT_HOUR,day:UNIT_DAY,month:UNIT_MONTH,year:UNIT_YEAR}},timeInterval:{data:5,type:TYPE_INTEGER},startTime:{data:new Date,type:TYPE_DATE},endTime:{data:new Date,type:TYPE_DATE},sensorThingsConfiguration:{data:[{data:{dataStreamUrl:{data:"",type:TYPE_FUZZY_SENSOR_SEARCH},mqttEnabled:{data:!1,type:TYPE_BOOLEAN},mqttUrl:{data:"",type:TYPE_STRING},mqttBaseTopic:{data:"",type:TYPE_STRING},updateIntervalMs:{data:1e3,type:TYPE_INTEGER}},type:TYPE_OBJECT}],type:TYPE_ARRAY}}}},{key:"newData",value:function(e){for(var t in this.allData=e,this.dataCallbacks)this.dataCallbacks[t](this.allData)}},{key:"registerViewCallback",value:function(e,t){this.dataCallbacks.push(e),this.configCallbacks.push(t),e(this.allData),t(this.configurableData)}},{key:"getDataCallback",value:function(){return[this.newData.bind(this)]}},{key:"destroy",value:function(){this.view.removeWidget(this.id),this.dataCallbacks=[]}},{key:"getID",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPosition",value:function(){return this.position}},{key:"getSize",value:function(){return this.size}},{key:"getQueryParams",value:function(){return this.configurableData.sensorThingsConfiguration.data}},{key:"getQueryIDs",value:function(){return this.queryIDs}},{key:"getConfigurableData",value:function(){return this.configurableData}},{key:"setConfigurableData",value:function(e){for(var t in this.configurableData=e,this.configCallbacks)this.configCallbacks[t](this.configurableData);this.widgetConfig.widgetDataChanged(this.id)}},{key:"setPosition",value:function(e){this.position=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setQueryIDs",value:function(e){this.queryIDs=e}}]),e}();t.TrafficLightWidgetData=o}])}]);
